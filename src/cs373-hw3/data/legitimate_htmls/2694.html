<!DOCTYPE html>

<!--[if lt IE 10]> <html lang="en" class="disable-flex"> <![endif]-->
<!--[if gte IE 10]> <html lang="en"> <![endif]-->
<!--[if !IE]>--> <html lang="en"> <!--<![endif]-->
<head><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="fragment" content="!" />
    <meta name="apple-itunes-app" content="app-id=403901186" />
    <meta name="google-play-app" content="app-id=com.kroger.mobile" />

    
    
    
    
    
    
    
    
    
    

    <title>Kroger</title>
    <link rel="shortcut icon" href="/static/g17d429e/image/favicon/kroger.ico" />
    <link rel="icon" type="image/x-icon" href="/static/g17d429e/image/favicon/kroger.ico" />

    <link rel="stylesheet" type="text/css" href="/static/g17d429e/stylesheet/application-site-header-footer.css" />
    <link rel="stylesheet" type="text/css" href="/static/g17d429e/stylesheet/application-site.css" />
    
    <link rel="stylesheet" type="text/css" href="/static/shoppinglist/api/build/shopping-list-components.css" />

    
    
    
    
    

    

    <script type="text/javascript">
        
         window.staticContentPath = '/static/g17d429e';
         
        window.localEnvironment = {};
    </script>
    <script src="/static/g17d429e/javascript/vendor/html5shiv.js"></script>
    <script src="/static/g17d429e/javascript/vendor/bowser.js"></script>
    <script src="/static/g17d429e/javascript/source/banner/unsupportedBrowsers.js"></script>

    <!-- if devLoadScripts is on, then jquery and angular are loaded up above from local -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.6/angular.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.6/angular-sanitize.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.6/angular-route.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.6/angular-resource.min.js"></script>
    <script src="/static/shoppinglist/api/build/shopping-list-api.js?cacheVersion=3.7.0"></script>
    <script src="/static/g17d429e/javascript/q.js"></script>

    
    <script src="/static/g17d429e/javascript/init.js"></script>
    <script src="/static/g17d429e/javascript/require.js"></script>
    <script src="/static/g17d429e/javascript/boot.prod.js"></script>
    

    <script type="text/javascript">
    requireQ(["everything"], function() {
  angular.module('environment', []).factory('EnvLookup', function() {
  return {
  bannerName: 'Kroger',
  bannerWithDeals: true,
  bannerDisplayName: 'Kroger',
  contextPath: '',
  divisionBanner: 'KROGER',
  firstName: null,
  loggedIn: false,
  enrolledInCommunityRewards: null,
  hasLoyaltyCard : 'undefined',
  isBeingPrerenderedForSearchCrawler : false,
  divisionNumber: null,
  storeCode: null,
  deliBakeryLinkEnabled : 'true',
  bannerParticipates: null,
  storeParticipates: null,
  kingsoopersParticipates : null,
  externalUrls: null,
  internalUrls: null,
  hasPharmacy: 'true',
  hasDeliBakery: 'true',
  bannerSiteDomain: 'Kroger.com',
  bannerSiteName: 'Kroger',
  plusCardName: 'Plus Card',
  noOfAllowedAttempts: '2',
  changePasswordPromptDate: '2014-May-27',
  heartBleedMessage: 'Our records indicate that you haven\'t changed your password recently. For security purposes, we recommend that you reset your password at this time.',
  isHeartBleedEnabled: 'true',
  contentVersion: '154a17eeb37',
  isCouponSearchEnabled: true,
  isCouponSearchEnabledBanner: true,
  isRecipeSearchEnabledBanner: true,
  isProductSearchEnabledBanner: true,
  isSearchServiceContentEnabled: null,
  nearStoreLocatorRadius: 8000,
  isAisleLocationEnabled: true,
  isPinnedListAnimationEnabled: false,
  couponPromotion: false,
  isCouponPromotionsEnabled: true,
  isWeeklyAdsEnabledForFM: false,
  couponPromotionPublishedAs: null,
  couponPromotionTabName: null,
  couponPromotionFilterTag: null,
  couponPromotionViewAllURL: null,
  couponPromotionImageId: null,
  couponPromotionMessageHeader: null,
  couponPromotionMessageText: null,
  couponPromotionButtonText: null,
  couponPromotionButtonAltId: null,
  couponPromotionButtonUrl: null,
  couponPromotionNotLoggedInMessageHeader: null,
  couponPromotionNotLoggedInMessageText: null,
  couponPromotionNotLoggedInButtonText: null,
  couponPromotionNotLoggedInButtonAltId: null,
  couponPromotionNotLoggedInButtonUrl: null,
  homeShopCookieName: 'eComm',
  homeShopBaseUrl: '/onlineshopping',
  homeShopShopNowUrl: '/onlineshopping',
  homeShopMyAccountEnabled: null,
  homeShopPickStoreServiceIntegrationEnabled: false,
  homeShopSecondPickStoreEnabled: false,
  searchServiceUrl:null,
  isRecipeRatingEnabled:false,
  isFacebookSharingEnabled:false,
  isPinterestSharingEnabled:true,
  isTwitterSharingEnabled:true,
  couponSpecialPromotionsEmailPreferenceId: 'Weekly Circular',
  couponSpecialPromotionsWebPostFlag: 'WeeklyAd',
  couponSpecialPromotionsFilteredTags: 'HOT',
  couponSpecialPromotionsGroupOptionId: 'Special Promotions and Opportunities',
  couponSpecialPromotionsEnabled: true,
  fredMeyerGrBaseDomain: '',
  fredMeyerCatalogId: '',
  fredMeyerStoreId: '',
  fredMeyerInstoreMenuEndpoint: '',
  fredMeyerGiftRegistryAutocompleteUrl: '',
  isManageAltIdEnabled: true,
  OnlineOrderingAvailableCatalog: '40,000',
  OnlineOrderingBrandName: 'ClickList',
  storeLocatorKey: 'AjxJ7VdncRQa6sl8Y-S6jdiqgGDzj7IKYT-0cvaIJsrvGuWk19f2OVnC2ym-_sGD',
  callCenterPhoneNumber: '1-866-221-4141',
  careersPageUrl: '/topic/careers',
  storeLocatorOptions : {
    text: 'Store',
    showServices: true,
    showAllBanners: true,
    showFuel: true,
    brand: 'KROGER'
  },
  bannerIsAuthenticated : true,
  wishabiWeeklyAdEnvironment: 'prod',
  divisionMap : {'011':'Atlanta','034':'Southwest','024':'Louisville','014':'Cincinnati','025':'Delta','026':'Nashville','016':'Columbus','018':'Michigan','029':'MidAtlantic','021':'Central'},
  listApiPath: '/api/shoppinglist',
  listJsApiVersion: '3.7.0',
  isPinnedShoppingListEnabled: true,
  isPinnedShoppingListLinkOnlyMode: false,
  isNotificationsEnabled: false,
  promotionModalEnabled: 'true',
  promotionModalAsset: '',
  isLiveNaturallyRibbonEnabled: true,
  promotionRibbonDesktopAsset: '',
  promotionRibbonTabletAsset: '',
  promotionRibbonMobileAsset: '',
  promotionLeftPanelAsset: '',
  promotionRightPanelAsset: '',
  promotionModalAltText: '',
  promotionRibbonAltText: '',
  promotionLeftPanelAltText: null,
  promotionRightPanelAltText: null,
  liveNaturallyPromotionLink: '',
  liveNaturallyPromotionModalLink: '',
  liveNaturallyLeftPanelLink: '',
  liveNaturallyRightPanelLink: '',
  promoSidePanelEnabled: true,

  pid: '',
  channel: 'web',
  loyalMember: null,
  omnitureAccount: 'krgrkrogerprod,krgrglobalprod',
  pscUrl: '/mysavings',
  getNotificationPercent: '0',
  preferredStoreDetails : null
  };
  });
});
  window.localEnvironment.flash = {
  slotContent: []
  }
  
</script>
    <script type="text/javascript">
  requireQ(["everything"], function() {
  angular.module('featureManager', []).factory('FeatureManager', function() {
    var activeFeatures = 'TOPIC_URL_OPTIMIZED,EXACT_TARGET_EMAIL,ECSB_FORGOT_PASSWORD'.split(',');

  return {
    isActive: function(name) {
      return $.inArray(name, activeFeatures);
    }
  };
  });

   });
  window.localEnvironment.flash = {
  slotContent: []
  }

  </script>
</head>

</head>
<script type="text/javascript">
  window.localEnvironment.servicesOffered = {
    slotContent: ['5721009784ae5be7164f3414','5721009784ae5be7164f3415','5721009784ae5be7164f3416','5721009884ae5be7164f3417','5721009884ae5be7164f3418','5721009884ae5be7164f341a','5721009884ae5be7164f341b','5721009884ae5be7164f341c'],
    attributes: '#0068b3'
  };
</script>
<body ng-really-cloak="true" id="ng-app" style="display:none;">
<scroll-to-top></scroll-to-top>

<span id="changeStoreContainer" class="slot">

  <script>requireQ(["everything"], function() {
  melange.gadgets.changeStoreController = function () {
    return function ($rootScope,
                     $scope,
                     windowReload,
                     StoreLocator,
                     StoreFunctions,
                     AccountService,
                     BrowserVersion,
                     Beacon,
                     timeoutService,
                     EnvLookup,
                     triggerChangeStoreGadgetService,
                     waitTimeHelper) {
      var loggedIn = EnvLookup.loggedIn;
      var isLittleClinic = EnvLookup.bannerName === 'TheLittleClinic';
      var init = function () {
        $scope.showChangeStore = false;
        $scope.storeLocatorText = EnvLookup.storeLocatorOptions.text;
        resetSearchFields();
      };

      triggerChangeStoreGadgetService.onTrigger(function () {
        $rootScope.$broadcast('closeStoreReminder');
        $scope.showChangeStore = true;
        $scope.storeSearchTerm = "";
        findStores($.cookie("StoreZipCode"));
      });

      $scope.searchStore = function () {
        findStores($scope.storeSearchTerm);
        $scope.searchMessage = 'Showing the top 5 results for ' + $scope.storeSearchTerm;
      };


      var findStores = function (searchTerm) {
        if (searchTerm) {
          $scope.currentSearchTerm = searchTerm;
          StoreLocator.query({address: searchTerm, radius: '3000', maxResults: 5}, function (data) {
            $scope.results = data;
            if (isLittleClinic === true) {
              $scope.waitTimeLoading = true;
              waitTimeHelper.addWaitTimesToStores(data).then(function(stores){
                $scope.results = stores;
                $scope.waitTimeLoading = false;
              });
            }

            if (_.isEmpty($scope.results)) {
              resetSearchFields();
              $scope.storeErrorText =
              "No " + $scope.storeLocatorText.toLowerCase() + "s were found within 3000 miles. Please provide additional address information or try again later.";
            } else {
              $scope.searchTerm = searchTerm;
              $scope.storeErrorText = "";
              $scope.showMoreResults = true;
            }
          }, function () {
            resetSearchFields();
            $scope.storeErrorText =
            "We're sorry, the search service is not available right now. Please try your search again later.";
          });
        }
      };

      var resetSearchFields = function () {
        $scope.searchTerm = "";
        $scope.results = [];
        $scope.storeErrorText = "";
        $scope.showMoreResults = false;
      };

      $scope.close = function () {
        resetSearchFields();
        $scope.showChangeStore = false;
        timeoutService.timeout(function() {
          $("a.change-store-link").focus();
        }, 0, false);
      };

      $scope.focusTopOfModal = function () {
        timeoutService.timeout(function() {
          $("#changeStoreSideModal").focus();
        }, 0, false);
      }

      $scope.focusOnMoreResultsLink = function () {
        //if ($scope.modalHeadingFocus) {
          timeoutService.timeout(function () {
            $("#moreResults").focus();
          }, 0, false);
        //}
      }

      $scope.makePreferredStore = function (store) {
        Beacon.registerPreferredStoreChange('Change Store Popup');
        timeoutService.timeout(function () {
          if (loggedIn) {
            var updateStoreInput = {'divisionNumber': store.storeInformation.divisionNumber, storeNumber: store.storeInformation.storeNumber};
            AccountService.updatePreferredStore(updateStoreInput, function () {
              updatePreferredStoreAndCloseModal(store)
            }, function (response) {
              store.storeInformationErrorText = response.data.errorMessage != null ?
                      response.data.errorMessage : "We're sorry, we are currently experiencing technical difficulties. Please try again later.";
              Beacon.registerPreferredStoreChangeError('Change Store Popup', 'server error');
            });
          }
          else {
            updatePreferredStoreAndCloseModal(store);
          }
        }, 200);
      };

      var updatePreferredStoreAndCloseModal = function (store) {
        store.storeInformationErrorText = "";
        $scope.close();
        StoreFunctions.makePreferredStore(store);
        windowReload.reload();
      };

      $scope.getStoreNumber = function () {
        var newVar = StoreFunctions.getDivisionId() + StoreFunctions.getStoreNumber();
        return  newVar;
      };

      $scope.getDescription = function (store) {
        return StoreFunctions.getDescription(store);
      };

      $scope.isPreferredStoreSet = function () {
        if (StoreFunctions.getPreferredStoreDetails()) {
          return true;
        }
        return false;
      };
      $scope.viewMoreResults = function() {
        var newUrl = '/storeLocator?storeSearchTerm='+$scope.currentSearchTerm+'&amp;distance=3000';

        var contains = new RegExp(".*storeSearchTerm="+$scope.currentSearchTerm+".*");
        if(contains.test(window.location.href)) {
          // close side modal if the query did not change
          $scope.close();
        }
        else {
          window.location.href = newUrl;
        }
      };

      init();
    }
  };

  melange.controller('changeStoreController', [
    '$rootScope', '$scope', 'windowReload', 'storeLocator.Service', 'storeFunctions.Service',
    'account.Service', 'browserVersion.Service', 'beacon.Service', 'timeoutService', 'EnvLookup', 'triggerChangeStoreGadgetService','waitTimeHelper',
    melange.gadgets.changeStoreController()
  ]);
});</script>
  <span ng-controller="changeStoreController" class="scoped-to-banner">
    <div id="changeStoreSideModal" side-modal="showChangeStore" data-qa="change store side modal" tabindex="{{ showChangeStore ? 0 : -1 }}" ng-focus="modalHeadingFocus=true;" ng-blur="modalHeadingFocus=false;">
      <div class="side-modal-window-shade"></div>
      <div class="side-modal-inner">
        <h1 id="changeStoreHeading" class="side-modal-heading" ng-show="isPreferredStoreSet()" data-qa="change-preferred-store-heading">Change Preferred {{storeLocatorText}}</h1>
        <h1 id="selectStoreHeading" class="side-modal-heading" ng-hide="isPreferredStoreSet()" data-qa="select-preferred-store-heading">Select Preferred {{storeLocatorText}}</h1>
        <a kr-shift-tab="focusOnMoreResultsLink()" class="side-modal-close-button" ng-click="close()" data-qa="change store close button" tabindex="{{showChangeStore ? 0 : -1 }}" href="" aria-label="Close Change Store Section">Close</a>
        <div id="storeSideModalSearchBox" class="side-modal-scrollable-area">
            <form ng-submit="searchStore()" name="searchStoreForm" class="change-store-search-field">
                <input id="changeStoreSearch" aria-label="search for store" data-qa="change store search input" name="store" type="text" ng-model="storeSearchTerm" ng-focus="true" placeholder="ZIP Code -OR- City,State" />
                <input type="submit" data-qa="change store submit button" value="Search" />
            </form>
            <div class="offscreen" aria-relevant="text" role="alert" aria-live="assertive"> {{ searchMessage }} </div>
            <div ng-show="storeErrorText" class="alert-error change-store-search-error" data-qa="change store search error">
              <p>{{storeErrorText}}</p>
            </div>
            <div class="change-store-content">
            <h3 ng-show="searchTerm" data-qa="change store results heading">Showing the top 5 results for {{searchTerm}}</h3>
            <ol>
              <li class="change-store-result" ng-repeat="store in results" data-qa="change store result">
                <h5 id="storeLocalName_{{$index}}" class="change-store-result-title" data-qa="change-store-result-title">{{ store.storeInformation.localName | uppercase }}</h5>
                <dl class="store-locator-store-info-phone-number" ng-if="waitTimeLoading">
                  <img src="static/image/spinner.05c22d8f09ec96f6.gif" width="16px" height="16px" alt="[SPINNER]" />
                  Loading Wait Time...
                </dl>
                <dl class="change-store-result-definition" name="clinicWaitTime" ng-if="store.waitTime">
                  <img src="/static/image/Clock_Blue_1x.447302f7575d05bc.png" />
                  <dt>Current Wait Time:</dt>
                  <dd data-qa="store locator result {{$index}} clinic wait time"><span>{{store.waitTime.description}}</span></dd>
                </dl>

                <div id="storeStreetAddress_{{$index}}" class="change-store-result-address" ng-bind-html="getDescription(store) | trusted" data-qa="change store result address"></div>

                <div data-qa="show-store-details">
                  <dl class="change-store-result-definition" name="storePhoneNumber" ng-show="store.storeInformation.phoneNumber">
                    <dt>{{storeLocatorText}} Phone:</dt>
                    <dd data-qa="change-store-result-store-phoneNumber">
                      <span phone-link="{{store.storeInformation.phoneNumber}}"></span>
                    </dd>
                  </dl>
                  <dl class="change-store-result-definition" name="pharmacyPhoneNumber" ng-show="store.pharmacyInformation.phoneNumber">
                    <dt>Pharmacy Phone:</dt>
                    <dd data-qa="change-store-result-pharmacy-phoneNumber">
                      <span phone-link="{{store.pharmacyInformation.phoneNumber}}"></span>
                    </dd>
                  </dl>
                </div>

                <dl class="change-store-result-definition -distance">
                  <dt>Distance:</dt>
                  <dd data-qa="change store result distance">{{ store.storeInformation.distance | roundToTwoDecimal}} miles</dd>
                </dl>

                <p tabindex="0" aria-describedby="storeStreetAddress_{{$index}}" class="change-store-result-preferred-indicator" ng-show="store.storeInformation.recordId == getStoreNumber()" data-qa="change store result indicate preferred store">This is My Preferred {{storeLocatorText}}</p>
                <input aria-describedby="storeStreetAddress_{{$index}}" type="button" class="change-store-result-preferred-button" ng-hide="store.storeInformation.recordId == getStoreNumber()" ng-click="makePreferredStore(store)" value="Make Preferred {{storeLocatorText}}" data-qa="change store make result preferred store" />

                <div class="change-store-details-links">
                  <a aria-describedby="storeStreetAddress_{{$index}}" data-qa="change-store-view-details" href="/storeHours?store={{store.storeInformation.recordId}}">View {{storeLocatorText}} Details</a>
                </div>

                <div ng-show="store.storeInformationErrorText" class="alert-error" data-qa="change store information {{$index}} error">
                  <p>{{store.storeInformationErrorText}}</p>
                </div>
              </li>
            </ol>
            <a id="moreResults" class="change-store-more-results-link" ng-show="showMoreResults" data-qa="showMoreResults" ng-click="viewMoreResults()" kr-tab="focusTopOfModal()" href="#">More Results &gt;&gt;</a>
          </div>
        </div>
      </div>
    </div>
  </span>
</span>

<div class="responsive-body-wrapper" responsive-body="true">
  <div>

    <!--
    OnlineOpinion v5.6.5
    Released: 12/17/2012. Compiled 01/02/2013 10:54:34 AM -0600
    Branch: master 6f7c9076b20d959805996192556bbd12b2014c7d
    Components: Full
    The following code is Copyright 1998-2013 Opinionlab, Inc.  All rights reserved. Unauthorized use is prohibited. This product and other products of OpinionLab, Inc. are protected by U.S. Patent No. 6606581, 6421724, 6785717 B1 and other patents pending. http://www.opinionlab
    --><!-- INVITATION PROMPT MARKUP -->
    <noscript>This JavaScript enables OnlineOpinion, a method for collecting secure feedback data.</noscript>
    <!-- IE 8 fix for handling the OpinionLab popup... -->
    <!--[if lt IE 9 ]>
    <script type="text/javascript">
        requireQ(["everything"], function () {
            (function () {
                var b = 0;

                function launchOOPopupInitOverride() {
                    var h = this.options,
                            g = h.newWindowSize || [545, 325],
                            m = [parseInt((h.metrics.height - g[1]) / 2, 10), parseInt((h.metrics.width - g[0]) / 2, 10)],
                            l, k, j = "location=no,status=no,width=" + g[0] + ",height=" + g[1] + ",top=" + m[0] + ",left=" + m[1],
                            ie7 = OOo.Browser.IE && navigator.userAgent.search("MSIE 7") !== -1,
                            ie8 = OOo.Browser.IE && navigator.userAgent.search("MSIE 8") !== -1;

                    windowName = "OnlineOpinion";

                    if (h.newWindow) {
                        windowName = windowName + (b++)
                    }

                    h.metrics.time2 = (new Date()).getTime();
                    h.metrics.type = "Popup";

                    if (h.asm || ie8) {
                        j += ",scrollbars=1"
                    }

                    l = OOo.appendOOForm(h, windowName);
                    k = window.open(ie7 || ie8 ? h.commentCardUrl || "https://secure.opinionlab.com/ccc01/comment_card_d.asp?" + l.children[0].value : "", windowName, j);

                    if (k && !ie7 && !ie8) {
                        l.submit()
                    }
                }

                OOo.extend(OOo.Ocode.prototype, {
                    launchOOPopup: launchOOPopupInitOverride
                })
            }());
        });
    </script>
    <![endif]-->
    <!-- END: OnlineOpinion v5.6.5 -->

    <script>/*<![CDATA[*/
requireQ(["everything"], function() {
  melange.controller('melange.app.opinionLabController', ['$scope', '$rootScope', '$window', '$timeout', 'EnvLookup', function($scope, $rootScope, $window, $timeout, EnvLookup) {
    $scope.popupIsVisible = false;
    $scope.isLittleClinic = EnvLookup.bannerName === 'TheLittleClinic';

    $scope.showPopup = function() {
      $scope.popupIsVisible = true;
    };

    $scope.hidePopup = function() {
      $scope.popupIsVisible = false;
    };

    $scope.showFeedback = function() {
      $scope.hidePopup();
      new OOo.Ocode({referrerRewrite:window.location.href.split('?')[0]}).show();
    };

    $rootScope.$on('showOpinionLabPopup', $scope.showPopup);

  }]);
});

/*]]>*/
</script>

    <div ng-controller="melange.app.opinionLabController" class="scoped-to-banner">
        <div id="oo_tab" class="oo_tab_right" tabindex="0" ng-click="showPopup()" ng-hide="popupIsVisible">
            <div data-qa="opinion_lab_feedback_link">
                <span></span>
            </div>
            <div class="screen_reader">Activate to launch feedback</div>
        </div>

        <div class="opinionlab-popup" side-modal="popupIsVisible" data-qa="opinionlab popup">
            <div class="side-modal-inner">
                <h1 class="side-modal-heading">Feedback</h1>

                <div class="side-modal-close-button" ng-click="hidePopup()" data-qa="opinionlab popup close button">
                    Close
                </div>
                <div class="side-modal-scrollable-area">
                    <div class="opinionlab-popup-content -first">
                        <div id="kroger_env"></div>
                        <h2>Need assistance? Email us.</h2>

                        <p>Send us your comments, questions and suggestions by email. We'll get right back to
                            you.</p>
                        <a class="button" data-qa="opinionlab email us link" href="/customercomments">Email
                            Us</a>
                    </div>
                    <div class="opinionlab-popup-content -second">
                        <div id="kroger_girl"></div>
                        <h2>Need assistance? Call us.</h2>

                        <p>Our Customer Service Ambassadors are ready to help you at <br /><span phone-link="1-866-221-4141"></span></p>
                        <a class="button" target="_blank" data-qa="opinionlab call us link" href="/topic/contact-us">Call Us</a>
                    </div>
                    <div class="opinionlab-popup-content -third">
                        <div id="kroger_bubble"></div>
                        <h2>Leave website feedback</h2>

                        <p>We want to hear from you, but please note that we cannot respond directly to your
                            feedback.</p>
                        <a class="button" href="javascript:void(0)" ng-click="showFeedback()">Leave Feedback</a>
                    </div>
                </div>
            </div>
            <div class="side-modal-window-shade"></div>
        </div>
    </div>

</div>
  <div><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script type="text/javascript">
  //<![CDATA[
  var axel = Math.random();
  var a = axel * 10000000000000;
  var bannerName ='Kroger'+ "";
  var url;
  if(bannerName == "TomT") {
    url = 'https://4884002.fls.doubleclick.net/activityi;src=4884002;type=' + 'alldi391' +';cat=' + 'kroge703' +';ord=' + a + '?';
  } else {
    url = 'https://1817628.fls.doubleclick.net/activityi;src=1817628;type=' + 'alldi391' +';cat=' + 'kroge703' +';u1=' +'Kroger'+';ord=1;num=' + a + '?';
  }
  var iframe = document.createElement("iframe");
  iframe.src = url;
  iframe.width = 1;
  iframe.height = 1;
  iframe.style.display = 'none';
  iframe.frameborder = 0;
  var reference = document.getElementsByTagName('script')[0];
  reference.parentNode.insertBefore(iframe, reference);
  //]]>

</script>

<noscript>
  <iframe width="1" height="1" frameborder="0" style="display:none" src="https://1817628.fls.doubleclick.net/activityi;src=1817628;type=alldi391;cat=kroge703;u1=[Division];ord=1;num=1?"></iframe>
</noscript></div>
  <div>
    <div class="flash-message-gadget">
  <script>/*<![CDATA[*/
requireQ(["everything"], function() {
  common.register('melange.gadgets.flashMessage', function () {
    return function ($scope, Content, Beacon) {
      var flashMessageTimeStamp;

      var initialize = function () {
        var slot_content = window.localEnvironment.flash.slotContent;
        Content.queryBySlotContent(slot_content, function (data) {
          if (!_.isEmpty(data)) {
            $scope.flashMessages = _.sortBy(data, function (flashMessage) {
              return flashMessage.order ? 1 / flashMessage.order.all : 0;
            });
            flashMessageTimeStamp = data[0].lastUpdatedOn;
          }
        });
      };

      $scope.shouldShowMessage = function () {
        return $scope.flashMessages && (!$.cookie("closedFlashMessageTimeStamp") ||
                                        ($.cookie("closedFlashMessageTimeStamp") !=
                                         flashMessageTimeStamp));
      };

      $scope.close = function () {
        Beacon.closeFlashMessage();
        $.cookie("closedFlashMessageTimeStamp", flashMessageTimeStamp);
      };

      initialize();
    }
  });

  melange.controller("flashMessageController",
      ['$scope', 'content.Service', 'beacon.Service', melange.gadgets.flashMessage()]);
});
/*]]>*/</script>
  <div><html>
<body>
<div>
    <script>/*<![CDATA[*/
requireQ(["everything"], function() {
    common.register('melange.gadgets.promoRibbon',
        melange.gadgets.promoRibbon = function ($scope, $window, Beacon, EnvLookup) {
            $scope.shouldShowRibbon = function() {
                if($scope.bannerName === 'KingSoopers') {
                    return EnvLookup.isLiveNaturallyRibbonEnabled != undefined && EnvLookup.isLiveNaturallyRibbonEnabled;
                }
                return false
            };
            $scope.navigateToLiveNaturally = function() {
               Beacon.registerPromoLinkClick("topnav_livenaturallypromo2015");
               $window.open($scope.targetPromoUrl, '_blank');
            };

            $scope.bannerName = EnvLookup.bannerName;

            $scope.desktopImgUrl = EnvLookup.promotionRibbonDesktopAsset;
            $scope.tabletImgUrl = EnvLookup.promotionRibbonTabletAsset;
            $scope.mobileImgUrl = EnvLookup.promotionRibbonMobileAsset;
            $scope.targetPromoUrl = EnvLookup.liveNaturallyPromotionLink;
            $scope.promotionRibbonAltText = EnvLookup.promotionRibbonAltText;
        });
    melange.controller('promoRibbonController',
        ['$scope', '$window', 'beacon.Service', 'EnvLookup', melange.gadgets.promoRibbon]);
});
/*]]>*/
</script>
    <div ng-controller="promoRibbonController">
        <div ng-show="shouldShowRibbon()" class="promoRibbon">
            <a href="" aria-label="{{ promotionRibbonAltText }}" tabindex="0" ng-click="navigateToLiveNaturally()">
                <span show-media-src="{{ mobileImgUrl }}" show-media="(max-width: 767px) " show-media-default="false"></span>
                <span show-media-src="{{ tabletImgUrl }}" show-media="(min-width: 768px) and (max-width: 1023px)" show-media-default="false"></span>
                <span show-media-src="{{ desktopImgUrl }}" show-media="(min-width: 1024px)" show-media-default="true"></span>
            </a>
        </div>
    </div>
</div>
</body>
</html></div>

  <div ng-controller="flashMessageController">
    <div ng-show="shouldShowMessage()" class="flashMsgContainer" data-qa="lol">
      <ul id="flashMsgList">
        <li class="flashMsg" id="flashMessage{{$index}}" ng-repeat="flashMessage in flashMessages">
          <span class="leftDescriptor" ng-show="flashMessage.title">{{flashMessage.title}}:</span><span class="leftDescriptorDetails" ng-bind-html="flashMessage.body | markdown | trusted"></span>
        </li>
      </ul>
      <a class="flashCloseButton" ng-click="close()" href="" aria-describedby="flashMsgList" aria-label="Close Messages" data-qa="bahaha">X</a>
    </div>
  </div>
</div>
  </div>
  <div><div id="browserWarnMsg" class="-hidden">
  <p>In order to use this site, please make sure that your cookies are enabled, then click <a href="javascript:history.go(0)">here</a> to refresh the page.</p>
</div>

<script type="text/javascript">

  requireQ(["everything"], function() {
    $(function(){
      var responsiveEnabled = $('.row-fluid').length > 0;

      if(!$.smartbanner) {
        return;
      }

      $.smartbanner({
        title:'Kroger',
        author:'Kroger',
        price:'FREE',
        appStoreLanguage: 'us',
        inAppStore: 'On the App Store',
        inGooglePlay: 'In Google Play',
        icon: '/static/g17d429e/image/appicon/kroger.png',
        iconGloss: null,
        button: 'View',
        scale: responsiveEnabled ? 1 : "auto",
        speedIn: 300,
        speedOut: 400,
        daysHidden: 15,
        daysReminder: 15,
        force: null  });

      var  ce = navigator.cookieEnabled;
      if (typeof navigator.cookieEnabled === "undefined") {
        if(!ce){
          document.cookie = "any";
          ce = (document.cookie.indexOf("any") !== -1);
          document.cookie = ""
        }
      }

      if(!ce )
        $( "#browserWarnMsg" ).removeClass("-hidden");

      if(!responsiveEnabled){
        $("#smartbanner").css("width", "1020px");
      }
    });
  });

</script>



</div>
    <div id="grid-flex">
        <div>

<script>/*<![CDATA[*/
requireQ(["everything"], function () {
   common.register('melange.gadgets.promoLeftPanel',
         melange.gadgets.promoLeftPanel = function ($scope, $window, Beacon, EnvLookup) {
            $scope.shouldShowLeftPanel = function () {
               if ($scope.bannerName === 'KingSoopers') {
                  return EnvLookup.promoSidePanelEnabled != undefined && EnvLookup.promoSidePanelEnabled;
               }
               return false
            };
            $scope.navigateToLiveNaturally = function () {
               Beacon.registerPromoLinkClick("leftpanel_livenaturallypromo2015");
               $window.open($scope.targetPromoUrl, '_blank');
            };

            $scope.bannerName = EnvLookup.bannerName;
            $scope.imgUrl = EnvLookup.promotionLeftPanelAsset;
            $scope.targetPromoUrl = EnvLookup.liveNaturallyLeftPanelLink;
            $scope.promotionLeftPanelAltText = EnvLookup.promotionLeftPanelAltText;
         });
   melange.controller('promoLeftPanelController',
         ['$scope', '$window', 'beacon.Service', 'EnvLookup', melange.gadgets.promoLeftPanel]);
});
/*]]>*/
</script>
<div ng-controller="promoLeftPanelController">
    <div ng-if="shouldShowLeftPanel()" class="promoPanels">
        <a href="" aria-label="{{ promotionLeftPanelAltText }}" tabindex="0" ng-click="navigateToLiveNaturally()">
            <span show-media-src="{{ imgUrl }}" show-media="(min-width: 1280px)" show-media-default="false" id="promoLeftPanelAsset"></span>
        </a>
    </div>
</div></div>
  <div id="grid-wrap" class="row-fluid">
    <div class="main">
      <fadeout-flash-message messages="fadeoutFlashMessages"></fadeout-flash-message>
      <div><script>/*<![CDATA[*/

requireQ(["everything"], function() {
  melange.controller('melange.app.responsiveNavigationController', [
    '$scope', '$timeout', '$rootScope', 'beacon.Service', "EnvLookup",
    melange.app.responsiveNavigationController = function ($scope, $timeout, $rootScope, Beacon, EnvLookup) {
      $scope.hideResponsiveNav = true;
      $scope.showResponsiveNav = false;
      $scope.bannerIsAuthenticated = EnvLookup.bannerIsAuthenticated;

      var toggleResponsiveNavOff = function () {
        $rootScope.$broadcast('showResponsiveNav', false);
        $scope.showResponsiveNav = false;
        $timeout(function () {
          $scope.hideResponsiveNav = true;
        }, 500);
      };

      $scope.$on("forceCloseResponsiveNav", toggleResponsiveNavOff);

      $scope.toggleResponsiveNav = function () {
        if (!$scope.showResponsiveNav) {
          Beacon.registerMobileMenuExpansion();
          $scope.hideResponsiveNav = false;
          $timeout(function () {
            $rootScope.$broadcast('showResponsiveNav', true);
            $scope.showResponsiveNav = true;
          }, 0);
        } else {
          toggleResponsiveNavOff();
        }
      };

    }
  ]);
});
/*]]>*/
</script>
<script>
  window.localEnvironment.signIn = {
    rememberMeEmail: null,
    rememberMeOption: null
  };
  window.localEnvironment.siteLogo = {
    bannerDisplayName: 'Kroger'
  };
  window.localEnvironment.topNavigation = {
    slotContent: ['520b89743283475a6784e570']
  };
</script>

<header role="banner">
  <div ng-controller="melange.app.responsiveNavigationController" class="scoped-to-banner">
    <div class="mobile-header">
      <a class="mobile-header-menu-button" data-qa="mobile header menu button" ng-class="{'active': showResponsiveNav}" ng-click="toggleResponsiveNav()"></a>
      <div class="mobile-menu-close-overlay" ng-show="showResponsiveNav" ng-click="toggleResponsiveNav()"></div>
      <a href="/" ng-click="track()" class="mobile-header-brand">Kroger</a>
    </div>

    <div id="aboveNavigation">
      <script>/*<![CDATA[*/
requireQ(["everything"], function() {
  melange.controller("headerController", [
    '$rootScope', '$scope', 'storeFunctions.Service', 'beacon.Service', '$window', '$timeout', 'EnvLookup', 'waitTime.Service', 'triggerChangeStoreGadgetService',
    melange.gadgets.navigationGadget =
    function ($rootScope, $scope, storeFunctions, Beacon, $window, $timeout, EnvLookup, WaitTimeService, triggerChangeStoreGadgetService) {
      $scope.preferredStoreId = '';

      $scope.isLittleClinic = EnvLookup.bannerName === 'TheLittleClinic';
      $scope.isPPSRx = EnvLookup.bannerName === 'PPSRx';
      $scope.showStoreDrawer = false;
      $scope.storeLocatorText = EnvLookup.storeLocatorOptions.text;

      var updateWaitTime = function() {
        if($scope.isLittleClinic) {
          var details = storeFunctions.getPreferredStoreDetails();
          if (details) {
            WaitTimeService.getWaitTime({clinicId: details.recordId}, function (data) {
              $scope.waitTime = data.description;
            });
          }
        }
      };

      var updateStoreCookies = function(){
        if(EnvLookup.loggedIn && !_.isUndefined(EnvLookup.preferredStoreDetails) && EnvLookup.preferredStoreDetails != null) {
          storeFunctions.makePreferredStore(EnvLookup.preferredStoreDetails);
        }
      };

      updateWaitTime();
      updateStoreCookies();

      $scope.isPreferredStoreSelected = function () {
        return $scope.preferredStoreId != '';
      };

      $scope.showWaitTimeIndicator = function () {
        return $scope.isLittleClinic && $scope.isPreferredStoreSelected();
      };

      $scope.openChangeStoreDrawer = function () {
        Beacon.registerChangeStoreLinkClick('change');
        triggerChangeStoreGadgetService.trigger();
        $timeout(function() {
          $("#changeStoreSideModal").focus();
        }, 0, false);
      };

      $scope.toggleStoreDrawer = function () {
        $rootScope.$broadcast('closeStoreReminder');
        $rootScope.$broadcast('headerDrawerWasToggled', 'storeDrawer');
        $scope.showStoreDrawer = !$scope.showStoreDrawer;
      };

      $scope.$on('headerDrawerWasToggled', function (e, drawerName) {
        if (drawerName != 'storeDrawer') {
          $scope.showStoreDrawer = false;
        }
      });

      $scope.$on('updateWaitTime', function(e) {
        updateWaitTime();
      });

      $scope.getPreferredStoreDetails = function () {
        var details = storeFunctions.getPreferredStoreDetails();
        if (details) {
          $scope.preferredStoreId = details.recordId;
          return details.address.prettyString;
        }
        return "No Store Selected";
      };

      $scope.preferredStoreAddress = $scope.getPreferredStoreDetails();

      $scope.isPreferredStoreSet = function () {
        if (storeFunctions.getPreferredStoreDetails()) {
          return true;
        }
        return false;
      };

      $scope.trackPreferredStoreClick = function () {
        Beacon.registerStoreClick('my store');
        $window.location.href = '/storeHours?store=' + $scope.preferredStoreId;
      };

      $scope.trackFindStoreLink = function () {
        Beacon.registerStoreClick('find a store');
      };

      common.linkBinder.bindOne("a[data-id='find-store-link']", $scope.trackFindStoreLink);
    }
  ]);
});
/*]]>*/
</script>
      <script>/*<![CDATA[*/
requireQ(["everything"], function() {
  melange.controller("promoModalController", [
    '$rootScope','$scope', 'beacon.Service', '$window', 'EnvLookup', '$timeout',
    melange.gadgets.promoModalController =
      function ($rootScope, $scope, Beacon, $window, EnvLookup, $timeout) {

        var hidePromotionModalList = ['/signin', '/login', '/account', '/forgotPassword'];
        var modalDismissed = $.cookie("modalClosed") === "true";
        var promotionEnabled = EnvLookup.promotionModalAsset != undefined && EnvLookup.promotionModalEnabled === "true" && EnvLookup.bannerName.toLowerCase() === "kingsoopers";
        var promoLink = EnvLookup.liveNaturallyPromotionModalLink ? EnvLookup.liveNaturallyPromotionModalLink : "https://www.kingsoopers.com/livenaturally?cid=web_2015P10_livenaturally_popup";

        $scope.promotionImgUrl = EnvLookup.promotionModalAsset;
        $scope.displayPromotionModal = promotionEnabled && !modalDismissed && !filterUrls($window.location.pathname, $window.location.hash);
        $scope.modalAltText = EnvLookup.promotionModalAltText;

        if ($scope.displayPromotionModal){
          $timeout(function(){
            $('#link-modal-image')[0].focus();
          }, 500, false);
        }

        $scope.focusModal = function(){
          $timeout(function(){
            $('#link-modal-image')[0].focus();
          }, 0, false);

        };

        $scope.focusCloseBotton = function(){
          $timeout(function(){
            $('#link-close-image')[0].focus();
          }, 0, false);
        };

        $scope.closePromoModal = function () {
          $.cookie("modalClosed", "true");
          $scope.displayPromotionModal = false;
        };

        $scope.onPromotionalModalClick = function () {
          $scope.closePromoModal();

          Beacon.registerPromoLinkClick("popup_livenaturallypromo2015");

          window.open(promoLink,'_blank');
        };

        function filterUrls(pathName, hashName) {
          var pathnameList = _.filter(hidePromotionModalList, function (item) {
            return pathName.toLowerCase().indexOf(item.toLowerCase()) > -1 ||
              hashName.toLowerCase().indexOf(item.toLowerCase()) > -1;
          });

          return pathnameList && pathnameList.length > 0;
        }
      }
  ]);
});
/*]]>*/

</script>
      <div ng-include="'/fragment/promoModal'"></div>
      <div id="siteLogoContainer" class="slot">
  <!--<script th:inline="javascript" type="text/javascript">-->
    <!--window.localEnvironment.siteLogo = {-->
      <!--bannerName: [[${bannerName}]]-->
    <!--};-->
  <!--</script>-->
  <script>/*<![CDATA[*/
requireQ(["everything"], function() {
  common.register('melange.gadgets.siteLogo',
      melange.gadgets.siteLogo = function ($scope, Beacon, EnvLookup) {

        $scope.trackSiteLogo = function () {
          Beacon.registerSiteLogoClick();
        };

        $scope.bannerName = EnvLookup.bannerName;

      });
  melange.controller('siteLogoGadgetController',
      ['$scope', 'beacon.Service', 'EnvLookup' , melange.gadgets.siteLogo]);
});
/*]]>*/
</script>
  <div ng-controller="siteLogoGadgetController" class="site-logo-gadget">
    <div id="logo" data-qa="siteLogo">
      <a href="/" ng-click="trackSiteLogo()">
        <img class="site-logo-gadget__image" alt="{{ bannerName }} Logo" title="Kroger" src="/asset/567807b384ae2fc86a1b1f45?data=1" />
      </a>
    </div>
  </div>
</div>
      <div class="headerContainer" ng-controller="headerController">
      <div id="preferredStore" ng-class="{'-little-clinic': isLittleClinic, '-ppsrx': isPPSRx}">
        <a href="javascript:void(0);" ng-click="toggleStoreDrawer()" ng-class="{active: showStoreDrawer}" class="store-drawer-toggle"><span class="drawer-toggle-hidden-label">Preferred Store Information</span></a>
        <change-store-reminder store-text="storeLocatorText"></change-store-reminder>
        <div class="preferred-store-drawer" ng-class="{'drawer-visible': showStoreDrawer}">
          <div class="preferred-store-drawer-wrapper" data-qa="preferred store section">
            <h4 data-qa="preferred store heading">My {{storeLocatorText}}: </h4>
            <a data-qa="preferred store hours link" class="storeHoursLink" ng-hide="preferredStoreId == ''" ng-click="trackPreferredStoreClick()" href="" ng-bind-html="getPreferredStoreDetails() | trusted"></a>
            <p ng-show="preferredStoreId == ''" class="no-preferred-store-message">No {{storeLocatorText}} Selected</p>
            <p id="waitTimeDivider" ng-class="{'-store-selected' : preferredStoreId != ''}" class="divider -wait-time">|</p>
            <div ng-class="{'-no-selected-store' : preferredStoreId == ''}" class="preferred-store-drawer-store-links">
              <a class="change-store-link" data-qa="navigation change store link" ng-show="isPreferredStoreSet()" ng-click="openChangeStoreDrawer()" href=""><span>Change {{storeLocatorText}}</span></a>
              <a class="change-store-link" data-qa="navigation select store link" ng-hide="isPreferredStoreSet()" ng-click="openChangeStoreDrawer()" href=""><span>Select {{storeLocatorText}}</span></a>
              <p class="divider">|</p>
              <a class="find-store-link" ng-click="trackFindStoreLink()" href="/storeLocator?hash=findStoreLink"><span> Find a {{storeLocatorText}} </span></a>
            </div>
          </div>
        </div>
      </div>
      <div>
        <div id="previewContextContainer" class="slot">
</div>
      </div>
      <div id="searchContainer" class="slot">
  <script>/*<![CDATA[*/
requireQ(["everything"], function() {
  common.register('melange.gadgets.search',
      melange.gadgets.search = function ($rootScope, $scope, $window, EnvLookup, windowSize, $location, $timeout, locationService) {


        var searchPath = '/searching';

        $scope.searchPlaceholderText = function(){
          if(windowSize.respondSmall()){
            return "Search"
          } else {
            return "What are you looking for today?";
          }
        };

        $scope.query = '';
        $scope.isLittleClinic = EnvLookup.bannerName === 'TheLittleClinic';

        $scope.toggleSearchDrawer = function () {
          if (!$scope.showSearchDrawer) {
            Beacon.registerMobileSearchIconClicked();
          }
          $rootScope.$broadcast('closeStoreReminder');
          $rootScope.$broadcast('headerDrawerWasToggled', 'searchDrawer');
          $scope.showSearchDrawer = !$scope.showSearchDrawer;
        };

        $rootScope.$on('searchTermChanged', function(e, searchQuery) {
          $scope.query = searchQuery;
        });

        $scope.$on('headerDrawerWasToggled', function (e, drawerName) {
          if (drawerName != 'searchDrawer') {
            $scope.showSearchDrawer = false;
          }
        });

        $scope.closeReminder = function () {
          $rootScope.$broadcast('closeStoreReminder');
        };

        $scope.find = function ($event) {
          if($event.currentTarget[0] && $event.currentTarget[0].nodeName === "INPUT") {
            $timeout(function() {
              $event.currentTarget[0].blur();
            });
          }
          redirectToSearch();
        };

        var redirectToSearch = function() {
          if($scope.query !== '') {
            var locationPath = locationService.locationPath();
            if (locationPath == searchPath) {
              $location.search({query: $scope.query});
            } else {
              $window.location.href = searchPath + '#?query=' + encodeURIComponent($scope.query) + '&contextUrl=' + encodeURIComponent(locationPath);
            }
          }
        };
      });

      melange.controller('melange.gadgets.searchGadgetController',
      ['$rootScope', '$scope', '$window', "EnvLookup", 'windowSize', '$location', '$timeout','locationService', melange.gadgets.search]);
});
/*]]>*/
</script>
  <div>
    <div ng-controller="melange.gadgets.searchGadgetController" class="search-container">
      <form search-and-account-name-layout="" id="search" name="search" role="search" ng-submit="find($event)" data-qa="search gadget mobile drawer">
        <div class="search-wrapper">
          <input class="non-fm-search-input" type="text" name="query" ng-click="closeReminder()" ng-keydown="closeReminder()" placeholder="{{searchPlaceholderText()}}" ng-model="query" ng-focus="searchFocus=true;" ng-blur="searchFocus=false;" data-qa="header search input" />
          <button type="submit" data-qa="search gadget submit" ng-focus="find($event)" ng-style="{ 'background-color': query ? '#cccccc' : 'clear' }">Search</button>
        </div>
      </form>
      <div pinned-list="" phone-mode="true" ng-class="{ '-minimized': searchFocus }"></div>
    </div>
  </div>
</div>

      <div class="authContainer">
        <div id="signInContainer" ng-show="bannerIsAuthenticated" class="slot">
    <script>/*<![CDATA[*/
requireQ(["everything"], function () {
  common.register('melange.gadgets.signIn', function () {
    return function ($rootScope, $scope, $window, $http, StoreFunctions, PromotionProgramService, Beacon, RedirectService, UrlUtilitiesService, EnvLookup, customerProfileService, timeoutService, windowSize, ValidationsService) {
      $scope.isPasswordExpired = false;
      $scope.bannerName = EnvLookup.bannerName;
      $scope.isPPSRx = $scope.bannerName.toLowerCase() === 'ppsrx';
      $scope.show = { signIn: true, clickListSignIn: true };
      var rememberMeEmail = window.localEnvironment.signIn.rememberMeEmail;
      var rememberMeOption = window.localEnvironment.signIn.rememberMeOption;
      $scope.responsiveEnabled = windowSize.responsiveEnabled();
      $scope.tabletOrMobile = function () {
        return $window.innerWidth < 768;
      };
      var homeShopBaseUrl = EnvLookup.homeShopBaseUrl;
      var ppsrxBaseUrl = "/myprescriptions";
      var isHomeShopPickStoreServiceIntegrationEnabled = EnvLookup.homeShopPickStoreServiceIntegrationEnabled;
      var signInPrompts = {
        myRecipes: 'Please log in to view My Recipes.',
        favorite: 'Please log in to save recipes.',
        shoppingList: 'Please log in to add ingredients to your Shopping List.',
        defaultPrompt: 'Sign in to view your account information.',
        rating:'Please log in to rate recipes.',
        productsList:'Sign in to add products to your list.'
      };
      var psc = EnvLookup.pscUrl.replace("/", "");
      var redirectUrl = RedirectService.requestHasRedirectUrl() ? RedirectService.getParameterByName('redirectUrl').replace('/', '') : "";
      var pathName = $window.location.pathname.substring($window.location.pathname.lastIndexOf('/') + 1);
      var action = $scope.action;
      signInPrompts[psc] = 'To view your Savings Center for coupons, sale items and more, please sign in.';

      $scope.pscCreateAccountPrompt = redirectUrl == psc || pathName == psc || action == psc;
      $scope.defaultCreateAccountPrompt = !$scope.pscCreateAccountPrompt;

      var redirectBasedSignInPrompt = function () {
        return RedirectService.requestHasRedirectUrl() ? signInPrompts[ RedirectService.getParameterByName('redirectUrl').replace('/', '')] : "";
      };

      var urlBasedSignInPrompt = function() {
        var url = $window.location.pathname;
        var pathname= url.substring(url.lastIndexOf('/') + 1);
        return signInPrompts[pathname];
      };

      var actionBasedSignInPrompt = function(){
        var actionBasedPrompt = $scope.action && signInPrompts[$scope.action];
        return actionBasedPrompt ? actionBasedPrompt : "";
      };

      $scope.signInPrompt = function() {
        var urlOrDefaultPrompt = urlBasedSignInPrompt() ? urlBasedSignInPrompt() : signInPrompts.defaultPrompt;
        if (actionBasedSignInPrompt()) {
          return actionBasedSignInPrompt();
        } else {
          return redirectBasedSignInPrompt() ? redirectBasedSignInPrompt() : urlOrDefaultPrompt;
        }
      };

      var init = function () {
        var userEmail = "";
        if (RedirectService.cookieEnabled()) {
          userEmail = localStorage.getItem("userEmail");
          timeoutService.timeout(function () {
            localStorage.removeItem("userEmail");
          }, 400);
        }

        $scope.account = { email: (_.isNull(userEmail) ? rememberMeEmail :
          userEmail), password: "", rememberMe: rememberMeOption };

        var href = $window.location.href;
        $scope.isHomeShop = $window.location.href.indexOf(homeShopBaseUrl) > -1;
        $scope.redirectUrlContains = function(token){
          if(RedirectService.requestHasRedirectUrl()){
            return token.indexOf(RedirectService.getParameterByName('redirectUrl')) >= 0;
          }
          return false;
        }
        $scope.show.signIn =
          ( href.indexOf('/#login') >= 0 || href.indexOf('/#/login') >= 0 ) ? true : false;
        $scope.isLoginError = false;
        $scope.isServiceError = false;
        $scope.emailErrorText = "";
        $("#emailError, #formEmailError").empty();
        $scope.passwordErrorText = "";
        $("#passwordError, #formPasswordError").empty();
        $scope.isLocked = false;
        $scope.isValidProgram = true;
        var queryParams = UrlUtilitiesService.getQueryParams();
        $scope.programName = queryParams.program;
        $scope.isEmailPreferenceError = queryParams.errorCode === "emailPreferenceNotSet";
        $scope.isSessionTimedOut = queryParams.errorCode === "sessionTimeout";

        var path = (!$scope.isHomeShop ? '/account/create' : homeShopBaseUrl + '/account/pickstore');
        if (RedirectService.requestHasRedirectUrl()) {
          path = path + '?' + RedirectService.getSearchString();
        }
        if (queryParams.program) {
          path = path + '?program=' + queryParams.program;
        }
        $scope.createAccountLink = path;

      };

      var hasErrors = function () {
        return  $scope.invalidEmailError || $scope.invalidPasswordError;
      };

      var validateEmail = function (isTest) {
        $scope.emailErrorText = false;
        var emailErrorText;
        if (_.isEmpty($scope.account.email)) {
          emailErrorText = 'Email is required';
          $scope.invalidEmailError = true;
        } else if (!ValidationsService.validateEmail($scope.account.email, true)) {
          emailErrorText = 'Email format is incorrect';
          $scope.invalidEmailError = true;
        }

        if($scope.invalidEmailError){
          timeoutService.timeout(function(){
              $scope.emailErrorText = emailErrorText;
          }, 0);
        }
        return $scope.emailErrorText;
      };

      var validatePassword = function () {
        $scope.passwordErrorText = undefined;

        if (_.isEmpty($scope.account.password)) {
          $scope.invalidPasswordError = true;
          timeoutService.timeout(function(){
            $scope.passwordErrorText = 'Password is required';
          });
        }

        return $scope.passwordErrorText;
      };

      var isUserHomeShopCustomer = function (data) {
        if (isHomeShopPickStoreServiceIntegrationEnabled) {
          if (data.userProfile
            && data.userProfile.bannerSpecificDetails
            && data.userProfile.bannerSpecificDetails[0]
            ) {
            return !_.isEmpty(data.userProfile.bannerSpecificDetails[0].pickupStoreDivisionNumber &&
              !_.isEmpty(data.userProfile.bannerSpecificDetails[0].pickupStoreNumber))
          }
        }
        else {
          //if homeshop has set cookie, honor it...
          var homeShopCookieName = "isHomeShopCustomer";
          var updatedValue;
          if ($.cookie(homeShopCookieName) != null) {
            updatedValue = customerProfileService.updateHomeShopCustomer($.cookie(homeShopCookieName));
          } else { //default to false since no cookie found
            updatedValue = customerProfileService.updateHomeShopCustomer(false);
          }
          return updatedValue;
        }
      };

      var isUserEmailOptedIn = function (data) {
        if (data.userProfile
                && data.userProfile.bannerSpecificDetails
                && data.userProfile.bannerSpecificDetails[0]
            && data.userProfile.bannerSpecificDetails[0].userEmailPreferences
            ) {
          var userEmailPreferences = data.userProfile.bannerSpecificDetails[0].userEmailPreferences;
          for (var index in userEmailPreferences) {
            if (userEmailPreferences[index].selected) {
              return true;
            }
          }
        }
        return false;
      };
      //TODO remove this function
      var isUserHotOffersEligible = function (data) {
        if (data.userProfile
                && data.userProfile.bannerSpecificDetails
                && data.userProfile.bannerSpecificDetails[0]
            && data.userProfile.bannerSpecificDetails[0].userEmailPreferences
            ) {
          var userEmailPreferences = data.userProfile.bannerSpecificDetails[0].userEmailPreferences;
          var couponSpecialPromotionsEmailPreferenceId = EnvLookup.couponSpecialPromotionsEmailPreferenceId;

          for (var index in userEmailPreferences) {
            if (userEmailPreferences[index].selected == true
                    && _.has(userEmailPreferences[index], "preferenceType")
                    && userEmailPreferences[index].preferenceType.indexOf("extras") > -1
                && userEmailPreferences[index].id == couponSpecialPromotionsEmailPreferenceId) {
              return true;
            }
          }
        }
        return false;
      };

      $scope.$on('signInCancelClicked', function () {
        $scope.show.clickListSignIn = true;
      });

      $scope.cancel = function () {
        Beacon.registerSignInCanceled();
        if ($scope.show.signIn) {
          $scope.show.signIn = false;
          $rootScope.$broadcast('signInCancelClicked');
          return;
        }
        if (RedirectService.requestHasCancelUrl()) {
          $window.location.href = "/weeklyAd";
          return;
        }
        if (RedirectService.requestHasRedirectUrl()) {
          // for coupon redirect
          RedirectService.performRedirect();
        }
        else {
          $window.location.href = "/";
        }
      };

      $scope.$on('headerDrawerWasToggled', function (e, drawerName) {
        if (drawerName != 'signinDrawer') {
          $scope.show.signIn = false;
        }
        else {
          $scope.show.clickListSignIn = !$scope.show.clickListSignIn;
        }
      });

      $scope.registerRegisterTabClicked = function () {
        Beacon.registerRegisterTabClicked();
      };

      $scope.toggleDrawer = function () {
        $rootScope.$broadcast('closeStoreReminder');
        $rootScope.$broadcast('headerDrawerWasToggled', 'signinDrawer');
        if ($scope.show.signIn) {
          $scope.show.signIn = false;
          $scope.isPasswordExpired = false;
        } else {
          init();
          Beacon.registerSignInClick();
          $scope.show.signIn = true;
          $scope.$broadcast('focusSigninEmailInput', "(min-width: 1px)");
          $window.scrollTo(0,0);
        }
      };

      $scope.$on('clickListSignInPressed', function (e) {
        $scope.toggleDrawer();
      });

      $scope.clickListSignIn = function () {
        $scope.show.clickListSignIn = false;
        $rootScope.$broadcast('clickListSignInPressed');
      };

      function closeDrawer() {
        $scope.show.signIn = false;
      }

      $scope.$on('toggleAccountDrawer', closeDrawer);
      $scope.$on('toggleSearchDrawer', closeDrawer);
      $scope.$on('toggleStoreDrawer', closeDrawer);

      $scope.$on('signInEvent', function (event, data) {
        if(data) {
         $scope.action = data.action;
         $scope.customRedirecturl = data.redirectUrl;
        }
        $scope.show.signIn = true;
        $scope.$broadcast('focusSigninEmailInput');
        $window.scrollTo(0,0);
      });

      $scope.submitClass = function () {
        return !$scope.disableSignIn() ? "submit mobileButtonEnabled" :
            "submit mobileButtonDisabled";
      };

      $scope.disableSignIn = function () {
        return _.isEmpty($scope.account.email) || _.isEmpty($scope.account.password);
      };

      $scope.submitOnIE8 = function () {
        if (isIE() == 8) {
          $scope.submit();
        }

        function isIE() {
          var myNav = navigator.userAgent.toLowerCase();
          return (myNav.indexOf('msie') != -1) ? parseInt(myNav.split('msie')[1]) : false;
        }
      };

      var resetErrors= function () {
        $scope.isLocked = false;
        $scope.isValidationError = false;
        $scope.isLoginError = false;
        $scope.isEmailPreferenceError = false;
        $scope.isServiceError = false;
        $scope.isSessionTimedOut = false;
        $scope.invalidEmailError = false;
        $scope.invalidPasswordError = false;
      };

      $scope.submit = function () {

        $('input[ng-model]').trigger('input');
        var href, signInLocation = '';
        href = $window.location.href;
        if ($scope.show.signIn) {
          signInLocation = 'signInModal'
        } else {
          signInLocation = ($scope.isHomeShop ? 'homeShopSignInPage' : 'signInPage');
        }
        var rememberMeFlag = $scope.account.rememberMe ? 'rememberMe_true' : 'rememberMe_false';
        Beacon.registerSignInAttempt(signInLocation, rememberMeFlag);

        resetErrors();
        var emailError = validateEmail();
        var passwordError = validatePassword();
        if (!hasErrors()) {
          $http.post("/user/authenticate",
              {account: $scope.account, location: $window.location.hash}).success(function (data) {
                data.hasOwnProperty('store') ? StoreFunctions.makePreferredStore(data['store']) :
                    StoreFunctions.removePreferredStore();
                customerProfileService.updateRegisteredUser(true);
                customerProfileService.updateHomeShopCustomer(isUserHomeShopCustomer(data));
                customerProfileService.updateEmailOptInUser(isUserEmailOptedIn(data));
                customerProfileService.updateEmailHotOffersUser(isUserEmailOptedIn(data));

                if (data.hasOwnProperty('loyaltyCard')) {
                  if (data['loyaltyCard'].length > 0) {
                    customerProfileService.updateLoyalMember(true);
                  } else {
                    customerProfileService.updateLoyalMember(false);
                  }
                }

                if (RedirectService.requestHasRedirectUrl()) {
                  Beacon.registerSignInSuccess(signInLocation, rememberMeFlag,
                      RedirectService.requestHasRedirectToExternalUrl());
                }
                else {
                  Beacon.registerSignInSuccess(signInLocation, rememberMeFlag);
                }

                if ("true" == EnvLookup.isHeartBleedEnabled) {
                  var momentLastChange = moment(data['userProfile']['dateLastPasswordChange']);
                  var momentPromptDate = moment(EnvLookup.changePasswordPromptDate, 'YYYY-MMM-DD');

                  var loginAttempts =
                      (_.isUndefined($.cookie("loginattempts")) ||
                       _.isEmpty($.cookie("loginattempts"))) ?
                          0 : $.cookie("loginattempts");

                  if ((momentLastChange.isBefore(momentPromptDate) &&
                       parseInt(loginAttempts) < parseInt(EnvLookup.noOfAllowedAttempts))) {
                    $.cookie("loginattempts", ++loginAttempts, {path: '/', expires: 730});
                    if (RedirectService.requestHasRedirectUrl()) {
                      $window.location.href = '/changePassword?redirectUrl=' +
                                              encodeURIComponent(RedirectService.getParameterByName('redirectUrl'));
                    } else {
                      $window.location.href = '/changePassword';
                    }
                  } else {
                    if (RedirectService.requestHasRedirectUrl()) {
                      timeoutService.timeout(function () { RedirectService.performRedirect(); }, 400);
                    }
                    else {
                      if ($scope.isHomeShop) {
                        $window.location.href = homeShopBaseUrl;
                        return;
                      }
                      $window.location.reload(true);
                    }
                  }
                } else {
                  if (RedirectService.requestHasRedirectUrl()) {
                    timeoutService.timeout(function () { RedirectService.performRedirect(); }, 400);
                  }
                  else {
                    if ($scope.isHomeShop) {
                      $window.location.href = homeShopBaseUrl;
                      return;
                    }

                    if ($scope.isPPSRx) {
                      $window.location.href = ppsrxBaseUrl;
                      return;
                    }

                    if ($scope.customRedirecturl) {
                      $window.location.href = $scope.customRedirecturl;
                    }

                    $window.location.reload(true);
                  }
                }
              }).error(function (data) {
                $scope.isPasswordExpired = data.isPasswordExpired;
                $scope.isLocked = data.isLocked;
                $scope.isValidationError = data.isValidationError;
                $scope.isLoginError = !($scope.isLocked) || $scope.isValidationError;
                if (data.isServiceError) {
                  $scope.isServiceError = data.isServiceError;
                  $scope.correlationId = data.correlationId;
                  $scope.errorTypeCode = data.errorTypeCode;
                  $scope.isLoginError = false;
                } else {
                  $scope.isServiceError = false;
                }
                var errorMsg = [];
                var messages = {
                  "Account has been locked": $scope.isLocked,
                  "Login credentials wrong": $scope.isLoginError,
                  "Sign In Service Error": $scope.isServiceError,
                  "Email Preferences problem": $scope.isEmailPreferenceError
                };
                _.each(_.keys(messages),
                    function (message) {
                      if (messages[message]) {
                        errorMsg.push(message);
                      }
                    });
                var trackingMessage = errorMsg.join("|");
                if ( $scope.isServiceError ) {
                  Beacon.registerSignInFailure(rememberMeFlag, signInLocation, trackingMessage,
                    $scope.errorTypeCode + ":" + $scope.correlationId);
                } else {
                  Beacon.registerSignInFailure(rememberMeFlag, signInLocation, trackingMessage);
                }
                $scope.account.password = "";
              });
        } else {
          $scope.account.password = "";
          var errorMsg;
          if (!_.isUndefined(emailError) && !_.isUndefined(passwordError)) {
            errorMsg = emailError + '_' + passwordError;
          } else if (!_.isUndefined(emailError) && _.isUndefined(passwordError)) {
            errorMsg = emailError;
          } else if (_.isUndefined(emailError) && !_.isUndefined(passwordError)) {
            errorMsg = passwordError;
          }
          Beacon.registerSignInFailure(rememberMeFlag, signInLocation, errorMsg);
        }
      };
      init();
    };
  });

  melange.controller("signInController", [
    '$rootScope', '$scope', '$window', '$http', 'storeFunctions.Service',
    'promotionalPrograms.Service', 'beacon.Service', 'redirect.Service',
    'urlUtilities.Service', 'EnvLookup' , 'customerProfile.Service',
    'timeoutService', 'windowSize', 'validations.Service',
    melange.gadgets.signIn()
  ]);
});
/*]]>*/
</script>

    <div ng-controller="signInController" class="authenticationGadget">

        <a href="javascript:void(0)" id="signIn" class="account-drawer-toggle drawer-toggle-hidden-label" ng-click="toggleDrawer()" ng-class="{active: show.signIn}">Sign In</a>

        <div class="sign-in-drawer" ng-class="{'drawer-visible': show.signIn}">

            <div class="sign-in-drawer-tabs">
                <span class="sign-in-drawer-tab -active">Sign In</span>
                <a class="sign-in-drawer-tab" ng-click="registerRegisterTabClicked()" ng-href="{{createAccountLink}}">Register</a>
            </div>
            <div aria-hidden="{{!show.signIn}}" class="sign-in-drawer-heading">
                <h1 ng-hide="isPasswordExpired">Sign In</h1>

                <h1 ng-show="isPasswordExpired">Attention</h1>
                <a href="" class="sign-in-drawer-close" ng-click="toggleDrawer()" tabindex="{{ show.signIn ? '0' : '-1'}}" aria-label="Close Sign in Section">
                    <img src="/static/image/icon_close.9a803fcf1318d425.png" width="21" height="21" alt="" />
                </a>
            </div>

            <div ng-show="isPasswordExpired"><div>
    <p>To protect your privacy and security, your account has been locked.</p>
    <p>You will not be permitted to access account-related features until your password is reset</p>
    <p>We have sent a link to reset your password to the email address associated with this account.</p>
</div></div>
            <div ng-hide="isPasswordExpired">

<form ng-submit="submit()" method="POST" ui-keypress="{13:'submitOnIE8()'}" class="signin-drawer-form cn-modal-content" name="signInForm" id="signInForm" autocomplete="off" novalidate="novalidate">
  <div aria-hidden="{{!show.signIn}}" aria-live="assertive">
    <p><i>{{signInPrompt()}}</i></p>

    <div role="alert" aria-live="assertive" ng-show="isEmailPreferenceError" class="section-error" data-qa="signin-drawer-email-preference-error">
      <p>We're sorry, due to technical difficulties, your email preferences have not been set. Please sign in to your account and navigate to your Account Summary to reselect your email preferences.</p>
    </div>
    <div role="alert" aria-live="assertive" ng-show="isLoginError" class="section-error" data-qa="signin-drawer-login-error">
      <p>There was a problem with the information that you entered. <br />Your login attempt was not successful.
      </p>
    </div>
    <div role="alert" aria-live="assertive" ng-show="isServiceError" class="section-error" data-qa="signin-drawer-service-error">
      <p>We're sorry, an unexpected error occurred during your sign-in attempt. <br />Please try signing in again.
      </p>
    </div>
    <div role="alert" aria-live="assertive" ng-show="isLocked" class="section-error" data-qa="signin-drawer-locked-error">
      <p> This account has been locked due to a problem with the information you entered. Please wait 30 minutes
        for the account to be unlocked and try again. Or, contact<a href="/ContactUs"> Customer Service</a> for help with your account.</p>
    </div>
    <div role="alert" aria-live="assertive" ng-show="isSessionTimedOut" class="section-error">
      <p>To protect your privacy, you have been signed out due to inactivity. Please sign in again.</p>
    </div>

    <ul>
      <li class="signin-drawer-field-item">
        <label for="signin-drawer-email-address">Email Address:</label>
        <input type="email" id="signin-drawer-email-address" data-qa="signin-drawer-email-address" size="40" ng-model="account.email" set-focus="focusSigninEmailInput" ng-class="{'-field-error':emailErrorText}" remove-default-ng-validations="true" tabindex="{{ show.signIn ? '0' : '-1'}}" />
        <div ng-show="emailErrorText" role="alert" aria-relevant="all" aria-live="polite" class="alert-error" data-qa="signin-drawer-email-error-text">
          <p>{{ emailErrorText }}</p>
        </div>
      </li>
      <li class="signin-drawer-field-item">
        <label for="signin-drawer-password">Password:</label>
        <input type="password" id="signin-drawer-password" data-qa="signin-drawer-password" size="40" ng-model="account.password" ng-class="{'-field-error':passwordErrorText}" autocomplete="off" tabindex="{{ show.signIn ? '0' : '-1'}}" />
        <div ng-show="passwordErrorText" role="alert" aria-relevant="all" aria-live="polite" class="alert-error" data-qa="signin-drawer-password-error-text">
          <p>{{ passwordErrorText }}</p>
        </div>
      </li>
      <li class="field-item -checkbox -small-bottom-margin">
        <span class="field-item-input-wrapper"><input type="checkbox" id="signin-drawer-remember-me" name="rememberMe" size="40" ng-model="account.rememberMe" tabindex="{{ show.signIn ? '0' : '-1'}}" /></span>
        <label for="signin-drawer-remember-me" class="unbold">Remember Me</label>
      </li>
    </ul>
    <div class="sign-in-other-actions">
      <a href="/forgotPassword" tabindex="{{ show.signIn ? '0' : '-1'}}">Forgot your password?</a>
      <p class="sign-in-drawer-create-account-link" ng-show="defaultCreateAccountPrompt">
        New to <span>Kroger</span>? <a ng-href="{{createAccountLink}}" tabindex="{{ show.signIn ? '0' : '-1'}}"> Create an account</a>
      </p>
      <p class="sign-in-drawer-create-account-link" ng-show="pscCreateAccountPrompt">
        Don't have a <span>Kroger.com</span> account? <a ng-href="{{createAccountLink}}" tabindex="{{ show.signIn ? '0' : '-1'}}"> Create an account</a> for access to your Savings Center and more.
      </p>
    </div>
    <div class="signin-drawer-field-item-buttons">
      <input id="signin-drawer-submit" data-qa="signin-drawer-submit" type="submit" value="Sign In" tabindex="{{ show.signIn ? '0' : '-1'}}" />
      <input type="button" id="signin-drawer-cancel" ng-click="cancel()" value="Cancel" class="cancelButton" tabindex="{{ show.signIn ? '0' : '-1'}}" />
    </div>
  </div>
</form>
</div>
        </div>

    </div>

</div>
        <div id="registrationContainer" ng-show="bannerIsAuthenticated" class="slot">

  <script type="text/javascript">
    requireQ(["everything"], function() {
      melange.controller('registration_identifier', [
        '$scope', '$window', 'beacon.Service', 'redirect.Service', 'EnvLookup',
        function ($scope, $window, Beacon, RedirectService, EnvLookup) {
          var pathName = window.location.href.split('/');
          var pageName = pathName[pathName.length - 1];
          var homeShopBaseUrl = EnvLookup.homeShopBaseUrl;
          var isHomeShop = $window.location.href.indexOf(homeShopBaseUrl) > -1;
          $scope.register = function () {
            var path = (!isHomeShop ? '/account/create' : homeShopBaseUrl + '/account/pickstore');
            Beacon.registerCreateAccountClick();
            $window.location.href = RedirectService.requestHasRedirectUrl() ?
                path + '?' + RedirectService.getSearchString() : path;
          }
        }
      ]);
    });
  </script>

  <div class="createAccountGadget" ng-controller="registration_identifier">
    <span id="createAccountLabel" class="register">No Account?</span>
    <a id="createAccount" href="javascript:void(0)" ng-click="register()" class="register">Register</a>
  </div>
</div>
        <div id="waitTimeContainer" ng-show="showWaitTimeIndicator()" class="wait-time-display">
          <div class="wait-time-header">
            Current Wait Time
          </div>
          <div class="wait-time-value">
            <div class="wait_time-text">{{waitTime}}</div>
          </div>
        </div>
      </div>

      <div id="preferredStoreBelow" ng-show="isLittleClinic">
        <h4 data-qa="preferred store heading">My {{storeLocatorText}}: </h4>
        <a data-qa="preferred store hours link" class="storeHoursLink" ng-hide="preferredStoreId == ''" ng-click="trackPreferredStoreClick()" href="" ng-bind-html="getPreferredStoreDetails() | trusted"></a>
        <span ng-show="preferredStoreId == ''">No {{storeLocatorText}} Selected</span>
        <p ng-show="waitTime" class="wait-time-label">
          <span class="wait-time-text">Current Wait Time: {{waitTime}}</span>
        </p>
      </div>

      </div>

    </div>

    <div class="navbarNavigation navbarNav">
      <a href="/" ng-click="track()" class="brand">Kroger</a>
      
      <div class="top-navigation" role="navigation" ng-class="{'-hidden-respond-small' : hideResponsiveNav }">
    <span class="desktop-navigation">
        <ul><li class="desktop-navigation__item menu-builder-list-item -level-1 -has-menu "><a href="#" class="desktop-navigation__link -level-1 "><span>Departments</span></a><ul><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/1-2-3-rewards-visa-card" class="desktop-navigation__link -level-2 "><span>1-2-3 REWARDS Visa Card</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/visa-prepaid-debit-card" class="desktop-navigation__link -level-2 "><span>Visa Prepaid Debit Card</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/adult-beverage" class="desktop-navigation__link -level-2 "><span>Adult Beverage</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/entertainment" class="desktop-navigation__link -level-2 "><span>Books &amp; Movies</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/deli-and-bakery" class="desktop-navigation__link -level-2 "><span>Deli &amp; Bakery</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/flowers-at" class="desktop-navigation__link -level-2 "><span>Floral</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/fresh-produce" class="desktop-navigation__link -level-2 "><span>Fresh Produce</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/fuel" class="desktop-navigation__link -level-2 "><span>Fuel</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/health-and-beauty-care" class="desktop-navigation__link -level-2 "><span>Health &amp; Beauty</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/in-store-services" class="desktop-navigation__link -level-2 "><span>In-Store Services</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/kroger-marketplace" class="desktop-navigation__link -level-2 "><span>Marketplace</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/meat-and-seafood" class="desktop-navigation__link -level-2 "><span>Meat &amp; Seafood</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="http://moneyservices.kroger.com" class="desktop-navigation__link -level-2 "><span>Money Services</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/natural-foods" class="desktop-navigation__link -level-2 "><span>Natural Foods</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/mobile-market" class="desktop-navigation__link -level-2 "><span>No-Contract Wireless</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/our-brands" class="desktop-navigation__link -level-2 "><span>Our Brands</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/pet" class="desktop-navigation__link -level-2 "><span>Pet Care</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/pharmacy" class="desktop-navigation__link -level-2 "><span>Pharmacy</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="http://www.thelittleclinic.com" class="desktop-navigation__link -level-2 "><span>The Little Clinic</span></a></li></ul></li><li class="desktop-navigation__item menu-builder-list-item -level-1 -has-menu "><a href="#" class="desktop-navigation__link -level-1 "><span>Savings</span></a><ul><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/mysavings" class="desktop-navigation__link -level-2 "><span>Savings Center</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/coupons" class="desktop-navigation__link -level-2 "><span>Digital Coupons</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/weeklyAd" class="desktop-navigation__link -level-2 "><span>Weekly Ad</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/fuel" class="desktop-navigation__link -level-2 "><span>Fuel</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/promotions" class="desktop-navigation__link -level-2 "><span>Promotions</span></a></li></ul></li><li class="desktop-navigation__item menu-builder-list-item -level-1 -has-menu "><a href="#" class="desktop-navigation__link -level-1 "><span>Order Online</span></a><ul><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/clicklist" class="desktop-navigation__link -level-2 "><span>ClickList Pick Up at Store</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/delibakery" class="desktop-navigation__link -level-2 "><span>Deli &amp; Bakery</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="https://kroger.wirelessairtime.com/" class="desktop-navigation__link -level-2 "><span>Mobile Top-Ups</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="http://ftdfloristsonline.com/kroger" class="desktop-navigation__link -level-2 "><span>Floral</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="http://www.fredmeyerjewelers.com/" class="desktop-navigation__link -level-2 "><span>Fred Meyer Jewelers</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="http://giftcards.kroger.com/" class="desktop-navigation__link -level-2 "><span>Gift Card Mall</span></a></li></ul></li><li class="desktop-navigation__item menu-builder-list-item -level-1 "><a href="/myprescriptions" class="desktop-navigation__link -level-1 "><span>My Prescriptions</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-1 -has-menu "><a href="#" class="desktop-navigation__link -level-1 "><span>Explore</span></a><ul><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="http://discoverfresh.kroger.com/" class="desktop-navigation__link -level-2 "><span>Discover Fresh</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/recipes" class="desktop-navigation__link -level-2 "><span>Recipes</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="http://kroger.inspiredgathering.com/" class="desktop-navigation__link -level-2 "><span>Inspired Gathering</span></a></li></ul></li><li class="desktop-navigation__item menu-builder-list-item -level-1 -has-menu "><a href="#" class="desktop-navigation__link -level-1 "><span>Community</span></a><ul><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/communityrewards" class="desktop-navigation__link -level-2 "><span>Commmunity Rewards</span></a></li><li class="desktop-navigation__item menu-builder-list-item -level-2 "><a href="/topic/community" class="desktop-navigation__link -level-2 "><span>In Your Community</span></a></li></ul></li></ul>
    </span>
    <span class="mobile-navigation" inject-feedback-link="true" feedback-li-class="mobile-navigation__item -level-1" feedback-a-class="mobile-navigation__link -level-1">
        <ul><li class="mobile-navigation__item menu-builder-list-item -level-1 -has-menu "><a href="#" class="mobile-navigation__link -level-1 "><span>Departments</span></a><ul><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/1-2-3-rewards-visa-card" class="mobile-navigation__link -level-2 "><span>1-2-3 REWARDS Visa Card</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/visa-prepaid-debit-card" class="mobile-navigation__link -level-2 "><span>Visa Prepaid Debit Card</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/adult-beverage" class="mobile-navigation__link -level-2 "><span>Adult Beverage</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/entertainment" class="mobile-navigation__link -level-2 "><span>Books &amp; Movies</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/deli-and-bakery" class="mobile-navigation__link -level-2 "><span>Deli &amp; Bakery</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/flowers-at" class="mobile-navigation__link -level-2 "><span>Floral</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/fresh-produce" class="mobile-navigation__link -level-2 "><span>Fresh Produce</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/fuel" class="mobile-navigation__link -level-2 "><span>Fuel</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/health-and-beauty-care" class="mobile-navigation__link -level-2 "><span>Health &amp; Beauty</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/in-store-services" class="mobile-navigation__link -level-2 "><span>In-Store Services</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/kroger-marketplace" class="mobile-navigation__link -level-2 "><span>Marketplace</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/meat-and-seafood" class="mobile-navigation__link -level-2 "><span>Meat &amp; Seafood</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="http://moneyservices.kroger.com" class="mobile-navigation__link -level-2 "><span>Money Services</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/natural-foods" class="mobile-navigation__link -level-2 "><span>Natural Foods</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/mobile-market" class="mobile-navigation__link -level-2 "><span>No-Contract Wireless</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/our-brands" class="mobile-navigation__link -level-2 "><span>Our Brands</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/pet" class="mobile-navigation__link -level-2 "><span>Pet Care</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/pharmacy" class="mobile-navigation__link -level-2 "><span>Pharmacy</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="http://www.thelittleclinic.com" class="mobile-navigation__link -level-2 "><span>The Little Clinic</span></a></li></ul></li><li class="mobile-navigation__item menu-builder-list-item -level-1 -has-menu "><a href="#" class="mobile-navigation__link -level-1 "><span>Savings</span></a><ul><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/mysavings" class="mobile-navigation__link -level-2 "><span>Savings Center</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/coupons" class="mobile-navigation__link -level-2 "><span>Digital Coupons</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/weeklyAd" class="mobile-navigation__link -level-2 "><span>Weekly Ad</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/fuel" class="mobile-navigation__link -level-2 "><span>Fuel</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/promotions" class="mobile-navigation__link -level-2 "><span>Promotions</span></a></li></ul></li><li class="mobile-navigation__item menu-builder-list-item -level-1 -has-menu "><a href="#" class="mobile-navigation__link -level-1 "><span>Order Online</span></a><ul><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/clicklist" class="mobile-navigation__link -level-2 "><span>ClickList Pick Up at Store</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/delibakery" class="mobile-navigation__link -level-2 "><span>Deli &amp; Bakery</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="https://kroger.wirelessairtime.com/" class="mobile-navigation__link -level-2 "><span>Mobile Top-Ups</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="http://ftdfloristsonline.com/kroger" class="mobile-navigation__link -level-2 "><span>Floral</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="http://www.fredmeyerjewelers.com/" class="mobile-navigation__link -level-2 "><span>Fred Meyer Jewelers</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="http://giftcards.kroger.com/" class="mobile-navigation__link -level-2 "><span>Gift Card Mall</span></a></li></ul></li><li class="mobile-navigation__item menu-builder-list-item -level-1 "><a href="/myprescriptions" class="mobile-navigation__link -level-1 "><span>My Prescriptions</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-1 -has-menu "><a href="#" class="mobile-navigation__link -level-1 "><span>Explore</span></a><ul><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="http://discoverfresh.kroger.com/" class="mobile-navigation__link -level-2 "><span>Discover Fresh</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/recipes" class="mobile-navigation__link -level-2 "><span>Recipes</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="http://kroger.inspiredgathering.com/" class="mobile-navigation__link -level-2 "><span>Inspired Gathering</span></a></li></ul></li><li class="mobile-navigation__item menu-builder-list-item -level-1 -has-menu "><a href="#" class="mobile-navigation__link -level-1 "><span>Community</span></a><ul><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/communityrewards" class="mobile-navigation__link -level-2 "><span>Commmunity Rewards</span></a></li><li class="mobile-navigation__item menu-builder-list-item -level-2 "><a href="/topic/community" class="mobile-navigation__link -level-2 "><span>In Your Community</span></a></li></ul></li></ul>
    </span>
    <broadcast-top-nav-loaded></broadcast-top-nav-loaded>
    <div pinned-list="" phone-mode="false"></div>

</div>
    </div>
  </div>
</header></div>
      <div class="contentBox" id="contentBox" role="main">
        <section role="region" aria-label="Promotions" id="main">
    <script>/*<![CDATA[*/
requireQ(["everything"], function() {
  common.register('melange.gadgets.hero', function (slot_content) {
    return function ($scope, Content, Asset) {

      if (slot_content.length == 0) return;

      var heroCollection = slot_content[0];
      $scope.heroes = [];
      $scope.isMultiHeroContent = false;
      Content.query({id: _.map(heroCollection.ids, function (item) {
        return item.identifier;
      })}, function (data) {
        $scope.heroes = data || [];
        $scope.isMultiHeroContent = $scope.heroes.length > 1;
        $.each($scope.heroes, function (index, hero) {
          if (hero && hero.image) {
            Asset.get({id: hero.image}, function (metadata) {
              hero.imageMetadata = metadata;
              hero.learnMoreLink =
              (!_.isEmpty(hero.externalUrl) ? hero.externalUrl : '/topic/' + hero.slug);
            });
          }
        });
      });
    }
  });
});
/*]]>*/</script>
    <script>
      requireQ(["everything"], function() {
        melange.controller('main_identifier', [
          '$scope', 'content.Service', 'asset.Service',
              melange.gadgets.hero([{'ids':[{'weight':2.503,'banners':{'BakersPlus':{'divisions':{'615':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.38'},'CityMarket':{'divisions':{'620':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.38'},'Dillons':{'divisions':{'615':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.38'},'FrysFood':{'divisions':{'660':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.38'},'JaycFoods':{'divisions':{'090':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.38'},'KingSoopers':{'divisions':{'620':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.38'},'Kroger':{'divisions':{'011':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'},'014':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'},'016':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'},'018':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'},'021':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'},'024':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'},'025':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'},'026':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'},'029':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'},'034':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true},'OwensMarket':{'divisions':{'021':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.38'},'PayLess':{'divisions':{'021':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.38'},'QFC':{'divisions':{'705':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.38'},'Ralphs':{'divisions':{'703':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.38'},'SmithsFoodAndDrug':{'divisions':{'706':{'weight':'0.38','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-02T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.38'}},'rules':{'and':[{'rule':'banners?.containsKey(bannerName)','weight':0.001},{'or':[{'and':[{'rule':'banners[bannerName]?.divisions?.containsKey(divisionNumber)','weight':'(banners[bannerName]?.divisions[divisionNumber]?.weight?:0.001).toDouble()'},{'rule':'((banners[bannerName]?.divisions[divisionNumber]?.startDate?:startDate)..(banners[bannerName]?.divisions[divisionNumber]?.endDate?:endDate)).containsWithinBounds(today)','weight':0.001}]},{'and':[{'rule':'banners[bannerName]?.allDivisionSelected','weight':'(banners[bannerName]?.weight?:0.001).toDouble()'},{'rule':'banners[bannerName].divisions.every{key,value-> ((value?.startDate?:startDate)..(value?.endDate?:endDate)).containsWithinBounds(today) }','weight':0.001}]}]},{'rule':'allowedLoginState == \'all\' || allowedLoginState == loggedIn.toString()','weight':0.5},{'rule':'allowedLoginStateShoppers == \'all\' || allowedLoginStateShoppers == hasLoyaltyCard.toString()','weight':0.5},{'rule':'userPreferredStore == \'all\' || userPreferredStore == hasPreferredStore.toString()','weight':0.5},{'rule':'registeredUser == \'all\' || registeredUser == isRegistered.toString()','weight':0.5},{'rule':'emailOptInUser == \'all\' || emailOptInUser == isEmailOptInUser.toString()','weight':0.5}]},'identifier':'571e7d4e84ae5be7164f338c','allowedLoginState':'all','allowedLoginStateShoppers':'all','userPreferredStore':'all','registeredUser':'all','emailOptInUser':'all'},{'weight':2.503,'banners':{'BakersPlus':{'divisions':{'615':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'},'CityMarket':{'divisions':{'620':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'},'Dillons':{'divisions':{'615':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'},'Food4Less':{'divisions':{'704':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'},'708':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true},'FoodsCo':{'divisions':{'701':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'},'FrysFood':{'divisions':{'660':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'},'Gerbes':{'divisions':{'615':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'},'KingSoopers':{'divisions':{'620':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'},'Kroger':{'divisions':{'011':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'},'014':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'},'016':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'},'018':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'},'021':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'},'024':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'},'025':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'},'026':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'},'029':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'},'034':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true},'OwensMarket':{'divisions':{'021':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'},'PayLess':{'divisions':{'021':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'},'QFC':{'divisions':{'705':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'},'Ralphs':{'divisions':{'703':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'},'SmithsFoodAndDrug':{'divisions':{'706':{'weight':'0.56','endDate':'2016-05-14T23:59:59.999-04:00','startDate':'2016-04-24T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.56'}},'rules':{'and':[{'rule':'banners?.containsKey(bannerName)','weight':0.001},{'or':[{'and':[{'rule':'banners[bannerName]?.divisions?.containsKey(divisionNumber)','weight':'(banners[bannerName]?.divisions[divisionNumber]?.weight?:0.001).toDouble()'},{'rule':'((banners[bannerName]?.divisions[divisionNumber]?.startDate?:startDate)..(banners[bannerName]?.divisions[divisionNumber]?.endDate?:endDate)).containsWithinBounds(today)','weight':0.001}]},{'and':[{'rule':'banners[bannerName]?.allDivisionSelected','weight':'(banners[bannerName]?.weight?:0.001).toDouble()'},{'rule':'banners[bannerName].divisions.every{key,value-> ((value?.startDate?:startDate)..(value?.endDate?:endDate)).containsWithinBounds(today) }','weight':0.001}]}]},{'rule':'allowedLoginState == \'all\' || allowedLoginState == loggedIn.toString()','weight':0.5},{'rule':'allowedLoginStateShoppers == \'all\' || allowedLoginStateShoppers == hasLoyaltyCard.toString()','weight':0.5},{'rule':'userPreferredStore == \'all\' || userPreferredStore == hasPreferredStore.toString()','weight':0.5},{'rule':'registeredUser == \'all\' || registeredUser == isRegistered.toString()','weight':0.5},{'rule':'emailOptInUser == \'all\' || emailOptInUser == isEmailOptInUser.toString()','weight':0.5}]},'identifier':'5711466584aecfa0230301ac','allowedLoginState':'all','allowedLoginStateShoppers':'all','userPreferredStore':'all','registeredUser':'all','emailOptInUser':'all'}]}] || [])
        ])
        ;
      });
    </script>
    <div ng-controller="main_identifier">
      <div id="heroGadget">
        <herocarousel heroes="heroes" tracking-name="hero"></herocarousel>
      </div>
    </div>
  </section>
        <div>
  <script>/*<![CDATA[*/

requireQ(["everything"], function() {
  common.register('melange.gadgets.servicesOffered', function () {

    return function ($scope, Content, Asset, $window, windowSize, Beacon) {
      $scope.backgroundColor = window.localEnvironment.servicesOffered.attributes;
      var slotContent = window.localEnvironment.servicesOffered.slotContent;
      $scope.services = [];
      $scope.index = 0;

      function getServices() {
        if (_.isEmpty(slotContent)) return;
        Content.query({id: slotContent}, function (data) {
          $scope.services = _.sortBy(data, function (service) {
            return service.order ? 1 / service.order.all : 0;
          });
          $.each($scope.services, function (index, item) {
            if (item.asset) {
              Asset.get({id: item.asset}, function (metadata) {
                item.imageMetadata = metadata;
              });
            }
          });
        });
      }

      $scope.trackServicesOffered = function (targetLink, elementName, index) {
        Beacon.registerServicesOfferedClick(targetLink, elementName, index);
      };

      $scope.currentServices = function () {
        var result = [];

        for (var i = 0; i < $scope.itemsPerPage && i < $scope.services.length; i++) {
          result.push($scope.services[(i + $scope.index) % $scope.services.length]);
        }
        return result;
      };

      // 07/01/15 bindMany doesn't work. removed id from html
      common.linkBinder.bindMany($scope.currentServices, 'a[data-id="service-offering"]', function(index, model) {
        $scope.trackServicesOffered(model.target, model.title, index + 1);
      });

      $scope.next = function () {
        $scope.index += $scope.itemsPerPage;
        $scope.index = $scope.index % $scope.services.length;
      };

      $scope.previous = function () {
        $scope.index -= $scope.itemsPerPage;
        if ($scope.index < 0)
          $scope.index = $scope.index + $scope.services.length;
      };

      $scope.resize = function () {
        $scope.index = 0;
        $scope.itemsPerPage = windowSize.rotatorColumnsForPage();
      };

      var init = function () {
        if (slotContent.length == 0) return;
        getServices();
        $scope.itemsPerPage = windowSize.rotatorColumnsForPage();
        windowSize.registerResizeCallback($scope.resize);
      };

      init();
    };
  });

  melange.controller("servicesOfferedController", [
    '$scope', 'content.Service', 'asset.Service', '$window', 'windowSize', 'beacon.Service',
    melange.gadgets.servicesOffered()
  ]);
});
/*]]>*/
</script>
  <div role="region" aria-label="Services Offered" aria-hidden="services.length > 0" ng-controller="servicesOfferedController" ng-style="{'background-color' : backgroundColor}" class="servicesOffered" ng-show="services.length > 0">
      <div class="carousel slide feature-carousel">
    <button class="prev-button" aria-label="Scroll Previous Service" ng-click="previous()" ng-show="services.length > itemsPerPage"></button>
    <ul class="slidingRotator services" services-offered-swipe="" ng-swipe-left="swipeLeft()" ng-swipe-right="swipeRight()" next="next()" previous="previous()">
      <li class="services-offered-item" ng-repeat="service in currentServices()">
        <a href="" ng-click="trackServicesOffered('{{service.target}}', '{{service.title}}', '{{$index+1}}')">
          <div class="services-offered-inner">
            <p class="services-offered-image">
              <img ng-src="{{ service.asset | assetSource }}" alt="" />
            </p>
            <div class="serviceOfferedText">
              <p data-id="service-offering-title" class="serviceOfferedTitle">{{service.title|exactTruncate:15:false }}</p>
              <p data-id="service-offering-description" class="serviceOfferedContent">{{service.body|exactTruncate:40:true }}</p>
            </div>
          </div>
        </a>
      </li>
    </ul>
    <button class="next-button" swipe="swipe" aria-label="Scroll Next Service" ng-click="next()" ng-show="services.length > itemsPerPage"></button>
  </div>
  </div>
</div>
        <div>
    <script>/*<![CDATA[*/
requireQ(["everything"], function () {
  common.register('melange.gadgets.notifications', function () {
    return function ($scope, EnvLookup, notificationService, beaconService, ffdService, timeoutService, $q) {
      var NOTIFICATION_CLOSED = "isNotificationClosed",
          NOTIFICATION_CATEGORY = "pscNotificationCategory",
          NOTIFICATION_GROUP = "pscNotificationGroup",
          COOKIE_OPTIONS = { expires: new Date((new Date()).setHours(23,59,59,999)) },
          ffdCheckDone = false;

      $scope.freeFridayNotification;
      $scope.displayNotifications = false;
      $scope.ffdLoadedToCard = false;

      var init = function() {

        if (EnvLookup.isNotificationsEnabled){
          $scope.isFfdLoadedToCard()
            .then($scope.getFFDNotifications)
            .then($scope.shouldDisplayNotifications)
        }
      };

      function hasNotificationBeenClosed() {
        return $.cookie(NOTIFICATION_CLOSED) === "true";
      }

      $scope.isNotificationPresent = function () {
        return $scope.freeFridayNotification != undefined;
      };

      $scope.isFfdLoadedToCard = function () {
        var servicePromise = $q.defer();
        if (EnvLookup.loggedIn === false || ffdCheckDone === true){
          servicePromise.resolve();
        } else {
          ffdCheckDone = true;
          ffdService.get(function (ffdCoupons) {
            $scope.ffdLoadedToCard = ffdCoupons == undefined || ffdCoupons.coupons == undefined || ffdCoupons.coupons.length === 0;
            servicePromise.resolve();
          });
        }

        return servicePromise.promise;
      };

      function isFfdLoadedCookiePresent(){
        var cookie = $.cookie("isffdLoadedToCard");
        return cookie != undefined && cookie === "true";
      }

      var getGroup = function () {
        var SHOULD_SEE_NOTIFICATION = "b_ffd";
        var SHOULD_NOT_SEE_NOTIFICATION = "a_ffd";

        if ($.cookie(NOTIFICATION_GROUP) == null) {
          $.cookie(
            NOTIFICATION_GROUP,
            (Math.random() < (EnvLookup.getNotificationPercent / 100)) ? SHOULD_SEE_NOTIFICATION : SHOULD_NOT_SEE_NOTIFICATION,
            COOKIE_OPTIONS
          );
        }

        return $.cookie(NOTIFICATION_GROUP);
      };

      var setCategory = function (hasPassedNotificationCriteria) {
        $.cookie(
            NOTIFICATION_CATEGORY,
            getGroup() + "_" + hasPassedNotificationCriteria.toString(),
            COOKIE_OPTIONS
        );
      };

      $scope.passesNotificationCriteria = function () {
        return $scope.isNotificationPresent() &&
          !hasNotificationBeenClosed() &&
          !isFfdLoadedCookiePresent() &&
          !$scope.ffdLoadedToCard;
      };

      $scope.shouldDisplayNotifications = function () {
        var GROUP_SHOULD_SEE_NOTIFICATION_AND_PASSED_NOTIFICATION_CRITERIA = "b_ffd_true";

        if (!EnvLookup.isNotificationsEnabled) {
          $.removeCookie(NOTIFICATION_CATEGORY);
          return false;
        }

        setCategory($scope.passesNotificationCriteria());

        $scope.displayNotifications = $.cookie(NOTIFICATION_CATEGORY) === GROUP_SHOULD_SEE_NOTIFICATION_AND_PASSED_NOTIFICATION_CRITERIA;
      };

      $scope.closeNotification = function () {
        $scope.notificationCloseMessage = "You have closed the notification message.";
        $.cookie(NOTIFICATION_CLOSED, true, COOKIE_OPTIONS);
        timeoutService.timeout(function() {
          $("#weeklyAds").find("a").focus();
        }, 0, false);
        beaconService.sendOmnitureVariablesAndEvents("notificationClosed", "ffdnotification_cancel");
        $scope.shouldDisplayNotifications();
      };

      $scope.omnitureFfdNotification = function () {
        beaconService.registerNotificationLinkClick();
      };

      $scope.getFFDNotifications = function () {
        var servicePromise = $q.defer();
        if (EnvLookup.isNotificationsEnabled == undefined || !EnvLookup.isNotificationsEnabled) {
          return;
        }

        notificationService.get(function (data) {
          $scope.freeFridayNotification = _.find(data.notifications, function (notification) {
            return notification.notificationType === "FOF";
          });
          servicePromise.resolve();
        });
        return servicePromise.promise;
      };

      $scope.getFFDNotifications();
      init();
    };
  });
  melange.controller("notificationsController", [
    '$scope', 'EnvLookup', 'notification.Service', 'beacon.Service', 'freefridaydownload.Service', 'timeoutService', '$q', melange.gadgets.notifications()
  ]);
});
/*]]>*/</script>
    <div ng-controller="notificationsController" class="notification-container">
        <div class="notification" ng-if="displayNotifications" data-qa="notificationContainer" role="region" aria-label="Notification">
            <img class="notification-icon" src="/static/image/alert-bell.61a4b799712c26bf.png" data-qa="notificationAlertImage" alt="" role="presentation" />

            <p id="notificationMessage" data-qa="notificationMessage" class="notification-text">Your Free Friday Download is now available! Check out this week's coupon and other digital coupons.</p>
            <a class="link-to-ffd-button" data-qa="linkToFFD" href="/mysavings" ng-click="omnitureFfdNotification()" aria-describedby="notificationMessage">View Coupons</a>

            <a data-qa="notificationCloseButton" class="notification-close-icon" ng-click="closeNotification()" href="javascript:void(0)" tabindex="0" aria-label="Close notification">
                <img src="/static/image/cross_blue_16X16.cfa729f645633ba2.png" />
            </a>
        </div>
        <div class="offscreen" role="alert" aria-live="assertive" tabindex="-1">{{notificationCloseMessage}}</div>
    </div>
</div>

        <div role="region" aria-label="Savings and Coupons">
          <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<script>/*<![CDATA[*/
requireQ(["everything"], function () {
melange.controller('dealsGadget', ['$scope', '$rootScope', '$window', 'EnvLookup', 'beacon.Service', melange.gadgets.dealsGadget = function ($scope, $rootScope, $window, EnvLookup, Beacon) {
  $scope.disableWeeklyAds = function(){
    return EnvLookup.bannerName === "FredMeyer" && !EnvLookup.isWeeklyAdsEnabledForFM;
  };

  $scope.weeklyAdsInitialized = false;
  $scope.couponsInitialized = false;
  $scope.couponPromotionsInitialized = false;
  var WEEKLY_ADS = "weeklyAds";
  var COUPONS = "coupons";
  var COUPON_PROMOTIONS = "couponPromotions";
  $scope.selectedTab = $scope.disableWeeklyAds() ? COUPONS: WEEKLY_ADS;
  $scope.fireTrackingEventForCouponsTab = !$scope.disableWeeklyAds();

  var init = function () {
    $scope.isCouponPromotionConfigured = EnvLookup.couponPromotion;
    $scope.couponPromotionTabName = EnvLookup.couponPromotionTabName;
    $scope.couponPromotionViewAllURL = EnvLookup.couponPromotionViewAllURL;
    $scope.isCouponPromotionsEnabled = EnvLookup.isCouponPromotionsEnabled;
  };

  $scope.getTabNum = function(){
    return ($scope.isCouponPromotionConfigured && $scope.isCouponPromotionsEnabled) ? "-three-tabs-full-width-on-small" : "-two-tabs-full-width-on-small";
  };

  $scope.switchToCoupons = function() {
    $scope.selectedTab = COUPONS;
    $rootScope.$broadcast('deals.switchedTo', 'coupons', true);
  };

  $scope.switchToCouponPromotions = function() {
    $scope.selectedTab = COUPON_PROMOTIONS;
    $rootScope.$broadcast('deals.switchedTo', 'couponPromotions');
  };

  $scope.switchToWeeklyAds = function() {
    $scope.selectedTab = WEEKLY_ADS;
    $rootScope.$broadcast( 'deals.switchedTo', 'weeklyAd');
  };

  $scope.showCoupons = function() {
    return $scope.couponsInitialized && $scope.selectedTab == COUPONS ;
  };

  $scope.showCouponsError = function() {
    return !$scope.couponsInitialized && $scope.selectedTab == COUPONS;
  };

  $scope.showCouponPromotions = function() {
    return $scope.couponPromotionsInitialized && $scope.selectedTab == COUPON_PROMOTIONS ;
  };

  $scope.showWeeklyAds = function() {
    return $scope.weeklyAdsInitialized && $scope.selectedTab == WEEKLY_ADS;
  };

  $scope.showWeeklyAdsError = function() {
    return !$scope.weeklyAdsInitialized && $scope.selectedTab == WEEKLY_ADS;
  };

  $scope.showAllWeeklyAds = function() {
    Beacon.registerShowAllClick('weekly ad widget', '/weeklyad');
  };

  $scope.showAllCoupons = function() {
    Beacon.registerShowAllClick('coupon widget', '/coupons');
  };

  $scope.showAllCouponPromotions = function() {
    Beacon.registerShowAllClick('coupon promotion', $scope.couponPromotionViewAllURL);
  };

  $scope.focusOnCoupons = function() {
    return $window.location.search == "?=Coupons" || EnvLookup.bannerName === "FredMeyer";
  };

  $scope.$on('deals.weeklyAdsInitialized', function () {
    $scope.weeklyAdsInitialized = true;
  });

  $scope.$on('deals.couponsInitialized', function () {
    $scope.couponsInitialized = true;
    if($scope.focusOnCoupons()){
      $scope.selectedTab = COUPONS;
      $rootScope.$broadcast( 'deals.switchedTo', 'coupons', $scope.fireTrackingEventForCouponsTab);
    }
  });

  $scope.$on('deals.couponPromotionsInitialized', function () {
    $scope.couponPromotionsInitialized = true;
    if($window.location.search == "?=CouponPromotions"){
      $scope.selectedTab = COUPON_PROMOTIONS;
      $rootScope.$broadcast( 'deals.switchedTo', 'couponPromotions');
    }
  });

  init();
}]);
});
/*]]>*/
</script>

<div class="deals-container" ng-controller="dealsGadget">
  <ul id="deals" class="deals-tabs" ng-class="getTabNum()">
    <li id="weeklyAds" class="deals-tab" ng-hide="disableWeeklyAds()" ng-class="{active: showWeeklyAds() || showWeeklyAdsError()}" ng-click="switchToWeeklyAds()">
      <a href="javascript:void(0);">Weekly Ad</a>
    </li>
    <li id="coupons" class="deals-tab" ng-class="{active: showCoupons() || showCouponsError()}" ng-click="switchToCoupons()">
      <a href="javascript:void(0);">Coupons</a>
    </li>
    <li id="couponPromotions" class="deals-tab" ng-class="{active: showCouponPromotions()}" ng-show="isCouponPromotionConfigured &amp;&amp; isCouponPromotionsEnabled" ng-click="switchToCouponPromotions()">
      <a href="javascript:void(0);">{{couponPromotionTabName}}</a>
    </li>
    <li class="view-all-link">
      <a ng-href="#" ng-click="showAllWeeklyAds()" class="dealsLink" ng-show="showWeeklyAds() || showWeeklyAdsError()" data-qa="view all ads">View All Weekly Ads</a>
      <a ng-href="#" ng-click="showAllCoupons()" class="dealsLink" ng-show="showCoupons() || showCouponsError()" data-qa="view all coupons">View All Coupons</a>
      <a ng-href="#" ng-click="showAllCouponPromotions()" class="dealsLink" ng-show="showCouponPromotions()" data-qa="view all promotions">View All</a>
    </li>
  </ul>

  <section id="weeklyAdsSection" ng-show="showWeeklyAds() &amp;&amp; !disableWeeklyAds()" ng-class="{noBottomPadding: showWeeklyAds() }" class="deals-section">
  <script>/*<![CDATA[*/
requireQ(["everything"], function() {
  common.register('melange.gadgets.weeklyAds', function () {
    return function ($scope,
                     WeeklyAds,
                     DealsService,
                     $timeout,
                     $window,
                     ShoppingList,
                     $filter,
                     EnvLookup,
                     $rootScope,
                     windowSize,
                     Beacon) {

      var adsPerSlide = 5;
      var chunksToLoad = 2;
      var carouselEl;
      $scope.ads = [];
      $scope.visibleAds = [];
      $scope.adChunkIndexes = [];
      $scope.adsLoading = true;
      $scope.adsViewed = 0;
      $scope.loadError = false;
      $scope.isPreviousDisabled = true;
      $scope.isForwardDisabled = false;
      //$scope.addToListEnabled = EnvLookup.isAddToListFromWeeklyAdGadgetEnabled;
      $scope.loggedIn = EnvLookup.loggedIn;
      $scope.currentPage = 0;

      $scope.preferredStoreSet = function () {
        return !_.isEmpty($.cookie("StoreCode"));
      };

      $scope.onNextSlide = function () {
        Beacon.registerWeeklyAdNavigationChange('next');
        getCarouselEl().off('slid').one('slid', function () {
          addVisibleAds(true);
          incrementChunksToLoad(true);
          syncCarouselState();
        });

        screenReaderMessage('You have scrolled to the right and have loaded new Weekly Ads.');
      };

      $scope.onPrevSlide = function () {
        Beacon.registerWeeklyAdNavigationChange('back');
        getCarouselEl().off('slid').one('slid', function () {
          syncCarouselState();
        });

        screenReaderMessage('You have scrolled to the left and have loaded new Weekly Ads.');
      };

      var screenReaderMessage = function (message) {
        $("#scrollMessage").empty();
        $("#scrollMessage").append('<div>'+message+'</div>');
        $timeout(function(){
          $("#scrollMessage").empty();
        }, 500);
      };

      $scope.getStarted = function () {
        Beacon.registerWeeklyAdGetStarted('get started');
        $window.location.href = '/storeLocator?hash=weeklyAd';
      };

      var syncCarouselState = function () {
        setCurrentPage();
        setButtonEnabledStates();
        $scope.$apply();
      };

      var setCurrentPage = function () {
        $scope.currentPage = getCarouselEl().data("bs.carousel").getActiveIndex();
      };

      var setButtonEnabledStates = function () {
        var totalPages = Math.ceil(_.flatten($scope.ads).length / adsPerSlide);
        $scope.isForwardDisabled = (totalPages - 1) == $scope.currentPage;
        $scope.isPreviousDisabled = $scope.currentPage == 0;
      };

      var getCarouselEl = function () {
        return carouselEl || $('#weeklyAdCarousel');
      };

      var incrementChunksToLoad = function (isNext) {
        if (getCurrentSlide(isNext) > (chunksToLoad - 1)) {
          chunksToLoad += 2;
        }
      };

      var addVisibleAds = function (isNext) {
        incrementChunksToLoad(isNext);
        var currentIndex = getCurrentSlide(true);
        var endIndexToLoad = (($scope.ads.length - 1) - (currentIndex + 2) > 0) ? currentIndex + 2 :
            currentIndex + 1;
        if ($scope.visibleAds.length <= chunksToLoad) {
          var newChunkArray = $scope.ads.slice(currentIndex + 1, endIndexToLoad);
          _.each(newChunkArray, function (chunk, index) {
            $scope.visibleAds.push(chunk)
          });
        }
      };

      var getCurrentSlide = function (isNext) {
        var index = carouselEl.find('.item.active').index();
        return isNext ? (index) : (index - 1);
      };

      if (windowSize.responsiveEnabled()) {
        windowSize.registerResizeCallback(function () {
          if ($scope.repaginateAdsForLayout(windowSize.rotatorColumnsForPage())) {
            carouselEl.find('.active').removeClass('active');
            carouselEl.find('.item:first-child').addClass('active');
            $scope.currentPage = 0;
            $scope.isPreviousDisabled = true;
            $scope.isForwardDisabled = Math.ceil(_.flatten($scope.ads).length / adsPerSlide) == 1;
          }
        });
      }

      $scope.repaginateAdsForLayout = function (newAdsPerSlide) {
        var oldAdsPerSlide = adsPerSlide;
        adsPerSlide = newAdsPerSlide;

        if (newAdsPerSlide != oldAdsPerSlide) {
          $scope.paginateAds([]);
          return true;
        }
      };

      $scope.paginateAds = function (ads) {
        var unchunkedAds = _.flatten($scope.ads).concat(ads);
        $scope.ads = [];
        $scope.visibleAds = [];
        $scope.adChunkIndexes = [];
        var chunksLoadedCount = 0;
        _.each(chunkArray(unchunkedAds, adsPerSlide), function (adChunk, index) {
          $scope.ads.push(adChunk);
          $scope.adChunkIndexes.push(index);

          if (chunksLoadedCount < chunksToLoad) {
            $scope.visibleAds.push(adChunk);
            chunksLoadedCount++;
          }
        });
      };

      $scope.onShowDetails = function (ad, showDetails, index, parentIndex) {
        var element;
        if (showDetails) {
          element = document.getElementById('hideDetails_' + parentIndex + '_' + (index-1));
          var productName = $filter('removeCDATATag')(ad.Title);
          Beacon.registerWeeklyAdViewDetails(productName, index);
        } else {
          element = document.getElementById('viewDetails_' + parentIndex + '_' + (index-1));
        }
        $timeout(function(){
          element.focus();
        });
      }

      $scope.addToList = function (ad) {
        var productName = $filter('removeCDATATag')(ad.Title);
        var krogerItem = buildKrogerItem(ad);
        var addToListSuccess = function(response) {
          showMessage(productName + " was successfully added to <a href=\"/list\">your shopping list</a>", "success");
          Beacon.registerWeeklyAdItemAddToList(productName, ad.CategoryId, "weekly ad widget");
        }

        var addToListFailure = function(error) {
          if(error.message === ShoppingList.AUTHENTICATION_TIMED_OUT || error.message === ShoppingList.NOT_LOGGED_IN){
            if(!$scope.loggedIn) {
              openSignInDrawer();
            } else {
              redirectToSignIn(error.redirecturl);
            }
          } else {
            showMessage("There was an error adding this item to your shopping list", "error");
            Beacon.registerWeeklyAdItemAddToList(productName, ad, "weekly ad widget");
          }
        }
        if ($scope.loggedIn) {
          ShoppingList.addItem(krogerItem).then(
              addToListSuccess,
              addToListFailure
          );

          } else {
              Beacon.registerWeeklyAdItemAddToList(productName, ad, "weekly ad widget");
              openSignInDrawer();
          }
      };

      $scope.$on('deals.switchedTo', function (e, id) {
        if (id != 'weeklyAd') return;
        Beacon.registerWeeklyAdNavigationChange('tab');
      });

      var showMessage = function(message, type){
        type = type || "warning";
        $rootScope.fadeoutFlashMessages = [
          { msgClass: type + "-msg", message: message }
        ];
      };

      var redirectToSignIn = function(redirecturl) {
        showMessage("You must be logged in to add items to your Shopping List.", "warning");
        var baseUrl = "//" + $window.location.host;
        $window.location.href = baseUrl + redirecturl;
      };

      var openSignInDrawer = function(){
        showMessage("You must be logged in to add items to your Shopping List.", "warning");
        $timeout(function() {
          $rootScope.$broadcast('signInEvent');
        }, 500);
      };

      var buildKrogerItem = function (wishabiItem) {
        return {
          displayName: $filter('removeCDATATag')(wishabiItem.Title),
          categoryId:wishabiItem.CategoryId,
          sourceMap: {'circular': wishabiItem.Id},
          smallImageFileUri: wishabiItem.ThumbnailFile,
          imageFileUri: wishabiItem.ImageFile,
          weeklyAdInfo:{
            startDate: wishabiItem.StartDate,
            endDate: wishabiItem.EndDate,
            priceString: wishabiItem.PriceString
          }
        };
      };

      var chunkArray = function (array, chunkSize) {
        var chunkedArray = [];
        if (array) {
          for (var i = 0; i < array.length; i += chunkSize) {
            chunkedArray.push(array.slice(i, i + chunkSize));
          }
        }
        return chunkedArray;
      };

      var init = function () {
        $scope.repaginateAdsForLayout(windowSize.rotatorColumnsForPage());
        $rootScope.$broadcast('deals.weeklyAdsInitialized');

        WeeklyAds.get(function (response) {
          $scope.paginateAds(response.Items);
          $scope.adsLoading = false;
          $scope.adsViewed = 5;
          carouselEl = $('#weeklyAdCarousel').carousel({interval: false});
        }, function () {
          $scope.ads = [];
          $scope.adsLoading = false;
          $scope.loadError = true;
        });
      };

      init();
    };
  });
});
/*]]>*/</script>
  <script>
    requireQ(["everything"], function() {
      melange.controller('weeklyAds_identifier', [
        '$scope', 'weeklyAds.Service', 'deals.Service', '$timeout', '$window',
        'ShoppingList', '$filter', 'EnvLookup',
        '$rootScope', 'windowSize', 'beacon.Service',
            melange.gadgets.weeklyAds(null || [])
      ]);
    });
  </script>

  <div ng-controller="weeklyAds_identifier">
    <div id="weeklyAdsTabContent">
      <div id="weeklyAdCarousel" class="carousel slide" deals-carousel-swipe="true" ng-swipe-left="swipeLeft()" ng-swipe-right="swipeRight()" ng-show="ads.length > 0">
        <div>
          <a class="left carousel-control" href="#weeklyAdCarousel" data-slide="prev" aria-label="Scroll Previous Weekly Ad Items" ng-disabled="isPreviousDisabled" ng-click="onPrevSlide()" tabindex="{{ isPreviousDisabled ? -1 : 0 }}">&lsaquo;</a>
        </div>
        <div class="carousel-inner">
          <div ng-repeat="(adChunkIndex, adChunk) in visibleAds track by $index" class="coupons-weeklyad-page item" ng-class="{active: $first}" data-qa="ad carousel page">
            <p id="weekly-ad-items-label" style="display: none">Weekly Ad Items</p>
            <ul aria-labelledby="weekly-ad-items-label">
              <li ng-repeat="ad in adChunk" class="deal" ng-class="{first: $first, last: $last}" data-qa="ad" data-qa-index="{{ $index }}" ng-if="$parent.$index &lt;= (currentPage + 2) &amp;&amp; $parent.$index &gt;= (currentPage - 2)" tabindex="0">
                <div class="deal-body">
                  <div class="deal-slider" ng-class="{'showing-details' : showDetails}">
                    <div ng-class="{noImage: !ad.ImageFile}" class="deal-image-container">
                      <img ng-hide="!ad.ImageFile" ng-src="{{ad.ImageFile}}" data-qa="ad image" />
                    </div>
                    <div aria-hidden="{{ showDetails }}" ng-show="!showDetails">
                      <h1 data-qa="ad title">{{ ad.PriceString | truncateWithEllipses:40:true }}</h1>
                      <p data-qa="ad description">{{ ad.Title | removeCDATATag | truncateWithEllipses:40:true }}</p>
                      <a class="weeklyad-show-details-button" ng-click="showDetails=!showDetails; onShowDetails(ad, showDetails, {{$index+1}}, {{ adChunkIndex }});" name="viewDetails" id="viewDetails_{{ adChunkIndex }}_{{ $index }}" href="" aria-label="View Details Link">View Details</a>
                    </div>
                    <div class="deal-details -ad-details" scroll-fade="showDetails" reset-scroll="showDetails" aria-hidden="{{ !showDetails }}" ng-show="showDetails">
                      <a class="weeklyad-hide-details-button" ng-click="showDetails=!showDetails; onShowDetails(ad, showDetails, {{$index+1}}, {{ adChunkIndex }});" name="hideDetails" id="hideDetails_{{ adChunkIndex }}_{{ $index }}" href="" aria-label="Hide Details Link">Hide Details</a>
                      <h5>{{ ad.Title | removeCDATATag }}</h5>
                      <p>{{ ad.PriceString }}</p>
                      <p>{{ ad.Description | removeCDATATag }}</p>
                    </div>
                  </div>
                  <a class="add-to-list-button" ng-click="addToList(ad)" name="viewDetails" id="addToList" href="#" tabindex="0">{{ loggedIn ? 'Add To List' : 'Sign in to Add' }}</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
        <div>
          <a class="right carousel-control" href="#weeklyAdCarousel" data-slide="next" aria-label="Scroll Next Weekly Ad Items" ng-disabled="isForwardDisabled" ng-click="onNextSlide()" tabindex="{{ isForwardDisabled ? -1 : 0 }}">&rsaquo;</a>
          <div id="scrollMessage" class="offscreen" role="alert" aria-live="assertive" tabindex="-1"></div>
        </div>
      </div>
      <div class="deals-section-error-panel -with-get-started-button" ng-show="(loadError || ads.length == 0)">
        <div id="dealsErrorSection" ng-show="(loadError || ads.length == 0) &amp;&amp; !adsLoading" class="deals-section-error-action" data-qa="weekly ad no store error">
          <h2>View Your Weekly Specials</h2>
          <p>Browse our online ad to see great weekly specials for your local store.</p>
          <a class="button" href="" ng-click="getStarted()" data-qa="weekly ad error get started button" aria-describedby="dealsErrorSection">Get Started</a>
        </div>
        <div class="deals-section-error-loading" ng-show="adsLoading">Loading</div>
      </div>
    </div>
  </div>
</section>
  <section id="couponsSection" ng-show="showCoupons()" data-qa="coupon section" ng-class="{noBottomPadding: showCoupons() }" class="deals-section">
  <script>/*<![CDATA[*/
requireQ(["everything"], function() {

  common.register('melange.gadgets.coupons', function () {

    return function ($scope, Coupons, DealsService, EnvLookup, $rootScope, $window, $timeout, windowSize, Beacon, UrlUtilities) {

      var couponsPerSlide = 5;
      var carouselEl;

      $scope.coupons = [];
      $scope.couponChunkIndexes = [];
      $scope.initialized = false;
      $scope.couponsLoading = true;
      $scope.isPreviousDisabled = true;
      $scope.isForwardDisabled = false;
      $scope.loggedIn = EnvLookup.loggedIn;
      $scope.pageIndex = 0;
      $scope.numberOfCoupons = true;
      $scope.activeIndex = 0;
      $scope.couponPromotionImageId = EnvLookup.couponPromotionImageId;
      $scope.currentPage = 0;

      var OMNITURE_NAME = 'coupon widget';

      $scope.hasFilterTag = function (promotion) {
        return  _.contains(promotion.filterTags, EnvLookup.couponPromotionFilterTag)
      };

      $scope.onNextSlide = function (loadingCouponToCard) {
        $scope.getCarouselEl().off('slid.deals').one('slid.deals', function () {
          if ($scope.numberOfCoupons) {
            loadMoreCoupons();
          }
          syncCarouselState();
        });
        if (loadingCouponToCard) return;
        Beacon.registerCarouselNavigationChange(OMNITURE_NAME, 'next');

        screenReaderMessage('You have scrolled to the right and have loaded new Coupons.');
      };

      $scope.onPrevSlide = function () {
        $scope.getCarouselEl().off('slid.deals').one('slid.deals', function () {
          syncCarouselState();
        });
        Beacon.registerCarouselNavigationChange(OMNITURE_NAME, 'back');

        screenReaderMessage('You have scrolled to the left and have loaded new Coupons.');
      };

      var screenReaderMessage = function (message) {
        $("#scrollCouponMessage").empty();
        $("#scrollCouponMessage").append('<div>'+message+'</div>');
        $timeout(function(){
          $("#scrollCouponMessage").empty();
        }, 500);
      };

      var syncCarouselState = function () {
        setCurrentPage();
        setButtonEnabledStates();
        $scope.$apply();
      };

      var setCurrentPage = function () {
        $scope.currentPage = $scope.getCarouselEl().data("bs.carousel").getActiveIndex();
      };

      var setButtonEnabledStates = function () {
        var totalCouponPages = Math.ceil(_.flatten($scope.coupons).length / couponsPerSlide);
        $scope.isForwardDisabled = (totalCouponPages - 1) == $scope.currentPage;
        $scope.isPreviousDisabled = $scope.currentPage == 0;
      };

      var disableNavigation = function() {
        $scope.isForwardDisabled = true;
        $scope.isPreviousDisabled = true;
      }

      $scope.getCarouselEl = function () {
        return carouselEl || $('#couponCarousel');
      };

      var getTotalVisibleCoupons = function () {
        try {
          var items = $scope.getCarouselEl().find('.active').find('.deal');
          if (items) return items.length;
        }
        catch (err) {
        }
        return 0;
      };

     var scrollToTopAndOpenSignInDrawer = function(actionWasTriggeredFromModal) {
        if (!actionWasTriggeredFromModal) {
          $rootScope.$broadcast('signInEvent');
          return;
        }
        $timeout(function() {
          $rootScope.$broadcast('signInEvent');
        }, 750);
      };

      var isFFdCoupon = function(coupon) {

        var ffdCoupon = _.find(coupon.filterTags, function (filterTag) {
          return "ff_" + EnvLookup.bannerName.toLowerCase() === filterTag.toLowerCase();

        });

        return ffdCoupon != undefined;
      }

      $scope.loadToCard = function (coupon, index) {
        var actionWasTriggeredFromModal = $scope.showCouponModal;
        if($scope.showCouponModal) {
          $scope.closeCouponModal();
        }
        var totalShowing = getTotalVisibleCoupons();
        if($scope.loggedIn){
          hideCouponOperations(coupon, true);
          Coupons.addCoupon(coupon, function (couponResponse) {
            $scope.activeIndex = $scope.getCarouselEl().find('.item.active').index();
            $rootScope.$broadcast('couponLoadedToCard', coupon.id);
            $scope.onNextSlide(true);
            $scope.showCouponDetails = false;
            $scope.$root.fadeoutFlashMessages = [
              {"message": "The coupon was successfully loaded to your card.", "msgClass": "success-msg"}
            ];
            loadMoreCoupons();
            Beacon.registerLoadCouponToCardFromCarousel(coupon, index, totalShowing, OMNITURE_NAME,
              'load to card', true);
            if(isFFdCoupon(coupon)){

              $.cookie("isffdLoadedToCard", true, new Date().getDate() + 1);
            }
          }, function (error) {
            hideCouponOperations(coupon, false);
            if (error.status == 403) {
              UrlUtilities.logoutRedirectToLogin('sessionTimeout');
            } else if (error.data.errors && error.data.errors == "noPlusCardOrPreferredStore") {
              if (!$scope.hasLoyaltyCard) Beacon.registerAddCardForCoupon(OMNITURE_NAME, coupon.id,
                index);
              $window.location.href = '/account/update?returnUrl=Coupons';
            } else {
              $scope.showCouponDetails = false;
              var errorMessage = (error.data.errors == "serviceCallFailed") ?
                error.data.serviceMessage : "There was an error loading the coupon to your card.";
              $scope.$root.fadeoutFlashMessages = [
                {"message": errorMessage, "msgClass": "warning-msg"}
              ];
            }
          });
        } else {
          var actionWasTriggeredFromModal = $scope.showCouponModal;
          var totalShowing = getTotalVisibleCoupons();
          Beacon.registerLoadCouponToCardFromCarousel(coupon, index, totalShowing, OMNITURE_NAME,
            'sign in to load', false);
          if (!actionWasTriggeredFromModal) {
            $rootScope.$broadcast('signInEvent');
            return;
          }
          $timeout(function() {
            $rootScope.$broadcast('signInEvent');
          }, 750);
        }
      };

      var processLoadToCard =  function (coupon,index){

      };

      $scope.$on('couponLoadedToCard', function (e, couponId) {
        $scope.removeCouponFromCarousel(couponId);
      });

      var hideCouponOperations = function (coupon, shouldHide) {
        coupon.hideLoadToCard = shouldHide;
        coupon.hideViewDetails = shouldHide;
      };

      $scope.removeCouponFromCarousel = function (couponId) {
        var allCoupons = _.flatten($scope.coupons);
        allCoupons = _.filter(allCoupons, function (coupon) {
          return coupon.id !== couponId;
        });
        $scope.coupons = [];
        $scope.paginateCoupons(allCoupons);
      };

      $scope.loadCardText = function () {
        if (!$scope.loggedIn) {
          return 'Sign in to Load';
        }
        else if ($scope.loggedIn && $scope.hasLoyaltyCard) {
          return 'Load to Card';
        }
        else ($scope.loggedIn && !$scope.hasLoyaltyCard)
        return  'Add Card to Load';
      };

      var filterPredicate = function (item) {
        var shouldShow = true;
        if (hasFilteredTags(item) == true) {
          shouldShow = false;
        }
        return shouldShow;
      };

      var loadCoupons = function (pageIndex) {
        $scope.initialized = true;

        Coupons.get({pageIndex: pageIndex}, function (response) {
          if (_.has(response, 'hasLoyaltyCard')) $scope.hasLoyaltyCard = response['hasLoyaltyCard'];

          response.coupons = _.filter(response.coupons, filterPredicate);

          $scope.paginateCoupons(response.coupons);
          $scope.couponsLoading = false;
          $scope.numberOfCoupons = response.numberOfCoupons > 0;
          carouselEl = $('#couponCarousel').carousel({interval: false});
        }, function () {
          $scope.coupons = [];
          $scope.couponsLoading = false;
          $scope.loadError = true;
          $scope.numberOfCoupons = false;
        });
      };

      var hasFilteredTags = function (coupon) {
        var filteredTags = EnvLookup.couponSpecialPromotionsFilteredTags.split(',');
        var filteredTagsFound = false;
        if (coupon.hasOwnProperty("filterTags")) {
          if (coupon.filterTags.length > 0) {
            _.each(coupon.filterTags, function (couponFilterTag) {
              _.each(filteredTags, function (filterTag) {
                if (couponFilterTag == filterTag) {
                  filteredTagsFound = true;
                  return;
                }
              });
            });
          }
        }
        return filteredTagsFound;
      };
      var loadMoreCoupons = function () {
        if ($scope.currentPage >= $scope.couponChunkIndexes.length - 3) {
          $scope.pageIndex += 1;
          $scope.isForwardDisabled = true;
          Coupons.get({pageIndex: $scope.pageIndex}, function (response) {
            response.coupons = _.filter(response.coupons, filterPredicate);
            $scope.paginateCoupons(response.coupons);
            $scope.numberOfCoupons = response.numberOfCoupons > 0;
            $scope.isForwardDisabled = false;
          }, function (e) {
            $scope.loadError = true;
          });
        }
      };

      $scope.$on('deals.switchedTo', function (e, id, fireBeacon) {
        if (id != 'coupons') return;
        if (!$scope.initialized) {
          $scope.repaginateCouponsForLayout(windowSize.rotatorColumnsForPage());
          loadCoupons(0);

          if (windowSize.responsiveEnabled()) {
            windowSize.registerResizeCallback(function () {
              if ($scope.repaginateCouponsForLayout(windowSize.rotatorColumnsForPage())) {
                carouselEl.find('.active').removeClass('active');
                carouselEl.find('.item:first-child').addClass('active');
                $scope.currentPage = 0;
                $scope.isPreviousDisabled = true;
                $scope.isForwardDisabled =
                Math.ceil(_.flatten($scope.coupons).length / couponsPerSlide) == 1;
              }
            });
          }
        }
        if(fireBeacon) {
          Beacon.registerCarouselNavigationChange(OMNITURE_NAME, 'tab');
        }
      });

      $scope.repaginateCouponsForLayout = function (newCouponsPerSlide) {
        var oldCouponsPerSlide = couponsPerSlide;
        couponsPerSlide = newCouponsPerSlide;

        if (newCouponsPerSlide != oldCouponsPerSlide) {
          $scope.paginateCoupons([]);
          return true;
        }
      };

      $scope.paginateCoupons = function (coupons) {
        var unchunkedCoupons = _.flatten($scope.coupons).concat(coupons);
        $scope.coupons = [];
        $scope.couponChunkIndexes = [];
        _.each(chunkArray(unchunkedCoupons, couponsPerSlide), function (couponChunk, index) {
          $scope.coupons.push(couponChunk);
          $scope.couponChunkIndexes.push(index);
        });
      };

      var chunkArray = function (array, chunkSize) {
        var chunkedArray = [];
        if (array) {
          for (var i = 0; i < array.length; i += chunkSize) {
            chunkedArray.push(array.slice(i, i + chunkSize));
          }
        }
        return chunkedArray;
      };

      $scope.openCouponModal = function(coupon, index, parentIndex) {
        $scope.modalCoupon = coupon;
        $scope.modalCoupon.index = index;
        disableNavigation();
        $scope.showCouponModal = true;
        Beacon.registerCarouselViewDetails(OMNITURE_NAME, coupon.id, index);
        $scope.couponBodyId = "couponBody-" + parentIndex + "-" + (index - 1);
        $scope.focusTopOfModal();
      };

      $scope.closeCouponModal = function() {
        $scope.showCouponModal = false;
        $('.side-modal-scrollable-area').scrollTop(0); //manip dom in controller :(
        setButtonEnabledStates();
        $scope.focusClickedDetails();
      };

      $scope.focusClickedDetails = function() {
        $("#"+$scope.couponBodyId).parent().focus();
        $scope.couponBodyId = "";
      };

      $scope.focusTopOfModal = function () {
        $timeout(function() {
         $("#couponModalHeading").focus();
        }, 0, false);
      };

      $scope.focusBottomOfModal = function () {
        if($scope.modalHeadingFocus) {
          $timeout(function () {
            $("#couponModalCancel").focus();
          }, 0, false);
        }
      };

      var init = function () {
        $scope.repaginateCouponsForLayout(windowSize.rotatorColumnsForPage());
        $rootScope.$broadcast('deals.couponsInitialized');
      };

      init();
    };
  });

  melange.controller("couponsController", [
    '$scope', 'coupons.Service', 'deals.Service', 'EnvLookup', '$rootScope', '$window', '$timeout',
    'windowSize', 'beacon.Service', 'urlUtilities.Service', melange.gadgets.coupons()
  ]);
});
/*]]>*/</script>

  <div ng-controller="couponsController">
    <div id="couponsTabContent">
      <div id="couponCarousel" class="carousel slide scoped-to-banner" deals-carousel-swipe="true" ng-swipe-left="swipeLeft()" ng-swipe-right="swipeRight()" ng-show="coupons.length > 0 &amp;&amp; !loadError">
        <div side-modal="showCouponModal" id="couponModalHeading" data-qa="coupon side modal" aria-hidden="!showCouponModal" kr-shift-tab="focusBottomOfModal()" tabindex="{{showCouponModal ? 0 : -1}}" ng-focus="modalHeadingFocus=true;" ng-blur="modalHeadingFocus=false;">
          <div class="side-modal-window-shade"></div>
          <div class="side-modal-inner">
            <h1 class="side-modal-heading" data-qa="coupon modal heading">{{modalCoupon.shortDescription}}</h1>
            <a class="side-modal-close-button" ng-click="closeCouponModal()" href="" data-qa="coupon modal close button" tabindex="{{showCouponModal ? 0 : -1}}">Close Coupon Details</a>

            <div class="side-modal-scrollable-area">
              <div class="coupon-modal-body">
                <img ng-hide="!modalCoupon.imageUrl" class="coupon-modal-body-image" ng-src="{{modalCoupon.imageUrl}}" />
                <div class="coupon-modal-body-text-heading">{{modalCoupon.shortDescription}}</div>
                <div class="coupon-modal-body-text">
                  <div class="coupon-details" data-qa="coupon details modal description">{{modalCoupon.requirementDescription}}</div>
                  <br />
                  <div>Limit of one coupon per item. Digital Coupons and paper coupons may not be combined on the purchase
                    of a single item.</div>
                </div>
                <br />
              </div>
              <div class="coupon-modal-buttons">
              <button class="coupon-modal-load-coupon-button operation" ng-click="loadToCard(modalCoupon, modalCoupon.index)" ng-hide="coupon.hideLoadToCard" tabindex="{{showCouponModal ? 0 : -1}}" data-qa="load coupon button modal">{{loadCardText()}}</button>
              <button id="couponModalCancel" class="coupon-modal-cancel-button operation" ng-click="closeCouponModal()" ng-hide="coupon.hideLoadToCard" tabindex="{{showCouponModal ? 0 : -1}}" data-qa="cancel button coupon modal" value="Cancel" kr-tab="focusTopOfModal()">Cancel</button>
              </div>
            </div>
          </div>
        </div>
          <div>
              <a class="left carousel-control" href="#couponCarousel" data-slide="prev" aria-label="Scroll Previous Coupons" ng-disabled="isPreviousDisabled" ng-click="onPrevSlide()" tabindex="{{ isPreviousDisabled ? -1 : 0 }}">&lsaquo;</a>
          </div>
        <div class="carousel-inner">
          <div id="couponChunks-{{$index}}-{{$first}}" ng-repeat="(chunkIndex, couponChunkIndex) in couponChunkIndexes track by $index" class="coupons-weeklyad-page item" theIndex="{{$index}}" theActiveIndex="{{activeIndex}}" ng-class="{active: activeIndex==$index}" data-qa="coupon carousel page">
              <p id="coupons-label" style="display: none">Coupons</p>
              <ul aria-labelledby="coupons-label">
                <li id="coupon-{{$index}}" ng-repeat="coupon in coupons[couponChunkIndex]" class="deal" ng-class="{first: $first, last: $last}" data-qa="coupon" data-qa-index="{{ $index }}" ng-if="$parent.$index &lt;= (currentPage + 2) &amp;&amp; $parent.$index &gt;= (currentPage - 2)" tabindex="0">
                  <div class="deal-body" id="couponBody-{{chunkIndex}}-{{$index}}">
                    <img class="deal-promo-img" ng-src="{{ couponPromotionImageId | assetSource }}" alt="" ng-show="hasFilterTag(coupon) &amp;&amp; !showCouponModal" />
                    <div class="deal-slider">
                      <div id="coupon-{{coupon.id}}" ng-class="{noImage: !coupon.imageUrl}" class="deal-image-container">
                        <img ng-hide="!coupon.imageUrl" ng-src="{{coupon.imageUrl}}" />
                      </div>
                      <h1 class="deal-header">{{ coupon.shortDescription }}</h1>
                    </div>
                    <a class="deal-details-button" href="" ng-click="openCouponModal(coupon, {{$index+1}}, {{chunkIndex}});" name="viewDetails" data-qa="coupon view details link-{{$index+1}}">View Details</a>
                    <a class="load-coupon-button operation" ng-click="loadToCard(coupon, {{$index+1}})" ng-hide="coupon.hideLoadToCard" href="" data-qa="load coupon button {{$index}}">{{loadCardText()}}</a>
                    <div ng-show="coupon.isLoaded" class="search-coupons-loaded-text" data-qa="loaded to card text" tabindex="{{ coupon.isLoaded ? 0 : -1 }}">
                       {{ coupon.isLoaded ? 'Loaded to Card' : '' }}
                    </div>
                  </div>
                </li>
              </ul>
          </div>
        </div>
        <div>
          <a class="right carousel-control" href="#couponCarousel" data-slide="next" data-qa="coupon carousel right arrow button" aria-label="Scroll Next Coupons" ng-disabled="isForwardDisabled" ng-click="onNextSlide()" tabindex="{{ isForwardDisabled ? -1 : 0 }}">&rsaquo;</a>
        </div>
          <div id="scrollCouponMessage" class="offscreen" role="alert" aria-live="assertive" tabindex="-1"></div>
      </div>
      <div class="deals-section-error-panel -with-get-started-button" ng-show="(loadError || coupons.length == 0)">
        <div ng-show="(loadError || coupons.length == 0) &amp;&amp; !couponsLoading" class="deals-section-error-action">
          <h2>We're sorry</h2>
          <p class="-coupon-get-started">There was a problem loading your coupons.
            Please click here to continue browsing all coupons.</p>
          <a class="button" href="/coupons">Get Started</a>
        </div>
        <div class="deals-section-error-loading" ng-show="couponsLoading">Loading</div>
      </div>
    </div>
  </div>
</section>

  <section id="couponPromotionsSection" ng-show="showCouponPromotions()" data-qa="couponPromotion section" ng-class="{noBottomPadding: showCouponPromotions() }" class="deals-section">
  <script>/*<![CDATA[*/

requireQ(["everything"], function() {
  common.register('melange.gadgets.couponPromotions', function () {

    return function ($scope,
                     Promotions,
                     DealsService,
                     EnvLookup,
                     $rootScope,
                     $window,
                     $timeout,
                     windowSize,
                     Coupons,
                     AccountService,
                     Beacon,
                     UrlUtilities) {

      var promotionsPerSlide = 5;
      var carouselEl;

      $scope.promotions = [];
      $scope.promotionChunkIndexes = [];
      $scope.initialized = false;
      $scope.promotionLoading = true;
      $scope.isPreviousDisabled = true;
      $scope.isForwardDisabled = false;
      $scope.loggedIn = EnvLookup.loggedIn;
      $scope.pageIndex = 0;
      $scope.numberOfPromotions = true;
      $scope.activeIndex = 0;
      $scope.currentPage = 0;
      $scope.optedForMyExtras = false;
      $scope.optedForHotOffer = false;
      $scope.couponPromotionPublishedAs = EnvLookup.couponPromotionPublishedAs;
      $scope.couponPromotionViewAllURL = EnvLookup.couponPromotionViewAllURL;
      $scope.couponPromotionImageId = EnvLookup.couponPromotionImageId;
      $scope.couponPromotionMessageHeader = EnvLookup.couponPromotionMessageHeader;
      $scope.couponPromotionMessageText = EnvLookup.couponPromotionMessageText;
      $scope.couponPromotionButtonText = EnvLookup.couponPromotionButtonText;
      $scope.couponPromotionButtonAltId = EnvLookup.couponPromotionButtonAltId;
      $scope.couponPromotionButtonUrl = EnvLookup.couponPromotionButtonUrl;
      $scope.couponPromotionNotLoggedInMessageHeader =
      EnvLookup.couponPromotionNotLoggedInMessageHeader;
      $scope.couponPromotionNotLoggedInMessageText =
      EnvLookup.couponPromotionNotLoggedInMessageText;
      $scope.couponPromotionNotLoggedInButtonText = EnvLookup.couponPromotionNotLoggedInButtonText;
      $scope.couponPromotionNotLoggedInButtonAltId =
      EnvLookup.couponPromotionNotLoggedInButtonAltId;
      $scope.couponPromotionNotLoggedInButtonUrl = EnvLookup.couponPromotionNotLoggedInButtonUrl;

      $scope.isMyExtras = ($scope.couponPromotionPublishedAs == 'myextras') ? true : false;
      $scope.isHotOffer = $scope.isMyExtras && (EnvLookup.couponPromotionFilterTag ==
                                                EnvLookup.couponSpecialPromotionsFilteredTags) ?
          true : false;

      var OMNITURE_NAME = 'coupon promotion';

      $scope.onNextSlide = function (loadingCouponToCard) {
        getCarouselEl().off('slid').one('slid', function () {
          if ($scope.numberOfPromotions) {
            $scope.pageIndex += 1;
          }
          syncCarouselState();
        });
        screenReaderMessage("You scrolled to the right and loaded new promotions.", "assertive");
        if (loadingCouponToCard) return;
        Beacon.registerCarouselNavigationChange(OMNITURE_NAME, 'next');
      };

      $scope.onPrevSlide = function () {
        getCarouselEl().off('slid').one('slid', function () {
          syncCarouselState();
        });
        screenReaderMessage("You scrolled to the left and loaded new promotions.", "assertive");
        Beacon.registerCarouselNavigationChange(OMNITURE_NAME, 'back');
      };

      var screenReaderMessage = function(message, alertLevel) {
        $timeout(function() {
          $scope.alertLevel = alertLevel;
          $scope.ariaScrollText = message;
        }, 0);
        $timeout(function() {
          $scope.alertLevel = "assertive";
          $scope.ariaScrollText = "";
        }, 500);
      };

      $scope.onShowDetails = function (promotion, showDetails, index) {
        if (showDetails) {
          Beacon.registerCarouselViewDetails(OMNITURE_NAME, promotion.id, index);
          screenReaderMessage(promotion.shortDescription + ". " + promotion.requirementDescription
            + ". Limit of one coupon per item. Digital Coupons and paper coupons may not be combined on the purchase of a single item." , "polite");
        }
      }

      var syncCarouselState = function () {
        setCurrentPage();
        setButtonEnabledStates();
        $scope.$apply();
      };

      var setCurrentPage = function () {
        $scope.currentPage = getCarouselEl().data("bs.carousel").getActiveIndex();
      };

      var setButtonEnabledStates = function () {
        var totalPages = Math.ceil(_.flatten($scope.promotions).length / promotionsPerSlide);
        $scope.isForwardDisabled = (totalPages - 1) == $scope.currentPage;
        $scope.isPreviousDisabled = $scope.currentPage == 0;
      };

      var getCarouselEl = function () {
        return carouselEl || $('#promotionCarousel');
      };

      $scope.hasFilterTag = function (promotion) {
        return  _.contains(promotion.filterTags, EnvLookup.couponPromotionFilterTag);
      };

      var disablePreviousNextOnLoad = function () {
        if (_.flatten($scope.promotions).length <= promotionsPerSlide) {
          $scope.isForwardDisabled = true;
          $scope.isPreviousDisabled = true;
        }
      }

      var getTotalVisibleCoupons = function () {
        try {
          var items = getCarouselEl().find('.active').find('.deal');
          if (items) return items.length;
        }
        catch (err) {
        }
        return 0;
      };

      $scope.loadToCard = function (coupon, index) {
        var totalShowing = getTotalVisibleCoupons();
        if($scope.loggedIn){
          hideCouponOperations(coupon, true);
          Coupons.addCoupon(coupon, function (couponResponse) {
            $scope.activeIndex = getCarouselEl().find('.item.active').index();
            $rootScope.$broadcast('couponLoadedToCard', coupon.id);
            $scope.onNextSlide(true);
            $scope.showCouponDetails = false;
            $scope.$root.fadeoutFlashMessages = [
              {"message": "The coupon was successfully loaded to your card.", "msgClass": "success-msg"}
            ];
            Beacon.registerLoadCouponToCardFromCarousel(coupon, index, totalShowing, OMNITURE_NAME,
              'load to card', true);

          }, function (error) {
            hideCouponOperations(coupon, false);
            if (error.status == 403) {
              UrlUtilities.logoutRedirectToLogin('sessionTimeout');
            } else if (error.data.errors && error.data.errors == "noPlusCardOrPreferredStore") {
              if (!$scope.hasLoyaltyCard) Beacon.registerAddCardForCoupon(OMNITURE_NAME, coupon.id,
                index);
              $window.location.href = '/account/update?returnUrl=CouponPromotions';
            } else {
              $scope.showCouponDetails = false;
              var errorMessage = (error.data.errors == "serviceCallFailed") ?
                error.data.serviceMessage : "There was an error loading the coupon to your card.";
              $scope.$root.fadeoutFlashMessages = [
                {"message": errorMessage, "msgClass": "warning-msg"}
              ];
            }
          });
        } else {
          $rootScope.$broadcast('signInEvent');
          Beacon.registerLoadCouponToCardFromCarousel(coupon, index, totalShowing, OMNITURE_NAME,
            'sign in to load', false);
        }
      };

      $scope.$on('couponLoadedToCard', function (e, couponId) {
        $scope.removeCouponFromCarousel(couponId);
      });

      var hideCouponOperations = function (coupon, shouldHide) {
        coupon.hideLoadToCard = shouldHide;
        coupon.hideViewDetails = shouldHide;
      };

      $scope.removeCouponFromCarousel = function (couponId) {
        var allCoupons = _.flatten($scope.promotions);
        allCoupons = _.filter(allCoupons, function (coupon) {
          return coupon.id !== couponId;
        });
        $scope.promotions = [];
        $scope.paginatePromotions(allCoupons);
      };

      $scope.loadCardText = function () {
        if (!$scope.loggedIn) {
          return 'Sign in to Load';
        }
        else if ($scope.loggedIn && $scope.hasLoyaltyCard) {
          return 'Load to Card';
        } else ($scope.loggedIn && !$scope.hasLoyaltyCard)
        return  'Add Card to Load';
      };

      var loadPromotions = function () {
        $scope.initialized = true;
        $scope.promotionsLoading = true;

        Promotions.get({filterTag: EnvLookup.couponPromotionFilterTag, isMyExtras: $scope.isMyExtras, optedForMyExtras: $scope.optedForMyExtras,
          isHotOffer: $scope.isHotOffer, optedForHotOffer: $scope.optedForHotOffer},
            function (response) {
              if (_.has(response, 'hasLoyaltyCard')) $scope.hasLoyaltyCard =
                                                     response['hasLoyaltyCard'];
              $scope.paginatePromotions(response.promotions);
              $scope.promotionsLoading = false;
              $scope.numberOfPromotions = response.numberOfPromotions > 0 ? true : false;
              carouselEl = $('#promotionCarousel').carousel({interval: false});
              disablePreviousNextOnLoad();
            }, function () {
              $scope.promotions = [];
              $scope.promotionsLoading = false;
              $scope.loadError = true;
              $scope.numberOfPromotions = false;
            });
      };

      $scope.$on('deals.switchedTo', function (e, id) {
        if (id != 'couponPromotions') return;
        if (!$scope.initialized) {
          $scope.repaginatePromotionsForLayout(windowSize.rotatorColumnsForPage());
          loadPromotions();

          if (windowSize.responsiveEnabled()) {
            windowSize.registerResizeCallback(function () {
              if ($scope.repaginatePromotionsForLayout(windowSize.rotatorColumnsForPage())) {
                carouselEl.find('.active').removeClass('active');
                carouselEl.find('.item:first-child').addClass('active');
                $scope.currentPage = 0;
                $scope.isPreviousDisabled = true;
                $scope.isForwardDisabled =
                Math.ceil(_.flatten($scope.promotions).length / promotionsPerSlide) == 1;
              }
            });
          }
        }
        Beacon.registerCarouselNavigationChange(OMNITURE_NAME, 'tab');
      });

      $scope.repaginatePromotionsForLayout = function (newPromotionsPerSlide) {
        var oldPromotionsPerSlide = promotionsPerSlide;
        promotionsPerSlide = newPromotionsPerSlide;

        if (newPromotionsPerSlide != oldPromotionsPerSlide) {
          $scope.paginatePromotions([]);
          return true;
        }
      };

      $scope.paginatePromotions = function (promotions) {
        var unchunkedPromotions = _.flatten($scope.promotions).concat(promotions);
        $scope.promotions = [];
        $scope.promotionChunkIndexes = [];
        _.each(chunkArray(unchunkedPromotions, promotionsPerSlide),
            function (promotionChunk, index) {
              $scope.promotions.push(promotionChunk);
              $scope.promotionChunkIndexes.push(index);
            });
      };

      $scope.showCouponPromotionsError = function () {
        return ($scope.loadError || $scope.promotions.length == 0) &&
               ($scope.couponPromotionPublishedAs == 'promotion');
      };

      $scope.showMyExtrasError = function () {
        if ($scope.isHotOffer) {
          return ($scope.loadError || !$scope.loggedIn ||
                  ($scope.loggedIn && $scope.optedForHotOffer && $scope.promotions.length == 0) ||
                  ($scope.loggedIn && !$scope.optedForHotOffer))
              && ($scope.isHotOffer);
        } else if ($scope.isMyExtras) {
          return ($scope.loadError || !$scope.loggedIn ||
                  ($scope.loggedIn && $scope.optedForMyExtras && $scope.promotions.length == 0) ||
                  ($scope.loggedIn && !$scope.optedForMyExtras))
              && ($scope.isMyExtras);
        }
      };

      $scope.showServerErrorForMyExtras = function () {
        return $scope.loadError && !$scope.promotionsLoading;
      }

      $scope.showNoCouponMessageForMyExtras = function () {
        if ($scope.isHotOffer) {
          return !$scope.loadError && $scope.loggedIn && $scope.optedForHotOffer &&
                 $scope.promotions.length == 0 && !$scope.promotionsLoading;
        } else if ($scope.isMyExtras) {
          return !$scope.loadError && $scope.loggedIn && $scope.optedForMyExtras &&
                 $scope.promotions.length == 0 && !$scope.promotionsLoading;
        }
      }

      $scope.showNotLoggedInMessageForMyExtras = function () {
        if ($scope.isHotOffer) {
          return (!$scope.loggedIn || ($scope.loggedIn && !$scope.optedForHotOffer)) &&
                 !$scope.promotionsLoading;
        } else if ($scope.isMyExtras) {
          return (!$scope.loggedIn || ($scope.loggedIn && !$scope.optedForMyExtras)) &&
                 !$scope.promotionsLoading;
        }
      }

      var chunkArray = function (array, chunkSize) {
        var chunkedArray = [];
        if (array) {
          for (var i = 0; i < array.length; i += chunkSize) {
            chunkedArray.push(array.slice(i, i + chunkSize));
          }
        }
        return chunkedArray;
      };

      var init = function () {
        $scope.repaginatePromotionsForLayout(windowSize.rotatorColumnsForPage());
        $rootScope.$broadcast('deals.couponPromotionsInitialized');

        if ($scope.loggedIn && $scope.couponPromotionPublishedAs == 'myextras') {
          AccountService.emailPreferences(function (response) {
            $scope.emailUngroupedPreferences = response.emailUngroupedPreferences;
            $scope.emailGroupedPreferences = response.emailGroupedPreferences;

            _.forEach(_.keys($scope.emailGroupedPreferences), function (key) {
              if (key.indexOf("extras") > -1) {
                _.forEach($scope.emailGroupedPreferences, function (groupedPref) {
                  _.forEach(groupedPref, function (child) {
                    if (child.selected) $scope.optedForMyExtras = true;

                    // Condition to check whether opted for HOT offer or not
                    if ((EnvLookup.couponSpecialPromotionsEmailPreferenceId == child.id) &&
                        child.selected) $scope.optedForHotOffer = true;
                  });
                });
              }
            });
            _.forEach($scope.emailUngroupedPreferences, function(emailPref){
                if(emailPref.selected) $scope.optedForHotOffer = true;
              }
            );
          });
        }
      };

      init();
    };
  });
});
/*]]>*/</script>
  <script>
    requireQ(["everything"], function() {
      melange.controller('couponPromotions_identifier', [
        '$scope', 'couponPromotions.Service', 'deals.Service', 'EnvLookup', '$rootScope', '$window',
        '$timeout', 'windowSize', 'coupons.Service', 'account.Service', 'beacon.Service', 'urlUtilities.Service',
            melange.gadgets.couponPromotions(null || [])
      ])
      ;
    });
  </script>

  <div ng-controller="couponPromotions_identifier">
    <div id="promotionsTabContent">
      <div id="promotionCarousel" class="carousel slide" deals-carousel-swipe="true" ng-swipe-left="swipeLeft()" ng-swipe-right="swipeRight()" ng-show="promotions.length > 0 &amp;&amp; !loadError">
        <div>
          <a class="left carousel-control" href="#promotionCarousel" data-slide="prev" aria-label="Scroll to Previous Promotion Items" ng-disabled="isPreviousDisabled" ng-click="onPrevSlide()" tabindex="{{ isPreviousDisabled ? -1 : 0 }}">&lsaquo;</a>
        </div>
        <div class="carousel-inner">
          <div id="promotionChunks-{{$index}}-{{$first}}" ng-repeat="(promotionChunkIndexIndex, promotionChunkIndex) in promotionChunkIndexes track by $index" class="deals item" ng-class="{active: activeIndex==$index}" data-qa="promotion carousel page">
            <p id="coupon-promotion-items-label" style="display: none">Promotion Items</p>
            <ul aria-labelledby="coupon-promotion-items-label">
              <li aria-relevant="all" id="promotion-{{promotionChunkIndexIndex}}-{{$index}}" ng-repeat="promotion in promotions[promotionChunkIndex]" class="deal" ng-class="{first: $first, last: $last}" data-qa="promotion" data-qa-index="{{ $index }}" ng-if="$parent.$index &lt;= (currentPage + 2) &amp;&amp; $parent.$index &gt;= (currentPage - 2)" tabindex="0">

                <div class="deal-body">
                  <img class="deal-promo-img" ng-src="{{ couponPromotionImageId | assetSource }}" alt="" ng-show="hasFilterTag(promotion) &amp;&amp; !showDetails" />
                  <div class="deal-slider" ng-class="{'showing-details' : showDetails}">
                    <div id="promotion-{{promotion.id}}" ng-class="{noImage: !promotion.imageUrl}" class="deal-image-container">
                      <img ng-hide="!promotion.imageUrl" ng-src="{{promotion.imageUrl}}" />
                    </div>
                    <div aria-hidden="{{showDetails}}">
                      <h1>{{ promotion.shortDescription }}</h1>
                    </div>
                    <div id="deal-{{promotionChunkIndexIndex}}-{{$index}}" class="deal-details" scroll-fade="showDetails" data-qa="promotion details" data-qa-state="{{ showDetails ? 'visible' : '' }}" reset-scroll="showDetails" aria-hidden="{{!showDetails}}">
                      <h5>{{ promotion.shortDescription }}</h5>
                      <p>{{ promotion.requirementDescription }}</p>
                      <p>Limit of one coupon per item. Digital Coupons and paper coupons may not be combined on the purchase of a single item.</p>
                    </div>
                  </div>
                  <a class="deal-details-button" ng-click="showDetails=!showDetails; onShowDetails(promotion, showDetails, {{$index+1}});" name="viewDetails" id="viewDetails" data-qa="promotion view details link" aria-label="{{showDetails ? 'Hide' : 'View'}} Details" ng-class="{'showing-details' : showDetails}" href="" role="alert" aria-live="assertive" aria-relevant="all">{{showDetails ? 'Hide' : 'View'}} Details</a>
                  <a class="load-coupon-button operation" ng-click="loadToCard(promotion, {{$index+1}})" ng-hide="promotion.hideLoadToCard" data-qa="promotion load to card button" href="">{{loadCardText()}}</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
        <div>
          <a class="right carousel-control" href="#promotionCarousel" data-slide="next" data-qa="promotion carousel right arrow button" ng-disabled="isForwardDisabled" ng-click="onNextSlide()" tabindex="{{ isForwardDisabled ? -1 : 0 }}" aria-label="Scroll to Next Promotion Items">&rsaquo;</a>
          <div class="offscreen" role="alert" aria-live="{{alertLevel}}" aria-relevent="all" tabindex="-1">
            {{ariaScrollText}}
          </div>
        </div>
      </div>
      <div class="deals-section-error-panel -with-get-started-button" ng-show="showCouponPromotionsError()">
        <div ng-show="loadError &amp;&amp; !promotionsLoading" class="deals-section-error-action">
          <h2>We're sorry</h2>
          <p class="-coupon-get-started">There was a problem loading your coupon promotions.
            Please click here to continue browsing all coupon promotions.</p>
          <a class="button" href="{{couponPromotionViewAllURL}}">Get Started</a>
        </div>
        <div ng-show="!loadError &amp;&amp; (promotions.length == 0) &amp;&amp; !promotionsLoading" class="deals-section-error-action">
          <h2>{{couponPromotionMessageHeader}}</h2>
          <p class="-coupon-get-started">{{couponPromotionMessageText}}</p>
          <a class="button" href="{{couponPromotionButtonUrl}}" title="{{couponPromotionButtonAltId}}">{{couponPromotionButtonText}}</a>
        </div>
        <div ng-show="promotionsLoading" class="deals-section-error-loading">Loading</div>
      </div>

      <div class="deals-section-error-panel -with-get-started-button" ng-show="showMyExtrasError()">
        <div ng-show="showServerErrorForMyExtras()" class="deals-section-error-action">
          <h2>We're sorry</h2>
          <p class="-coupon-get-started">There was a problem loading your coupon promotions.
            Please click here to continue browsing all coupon promotions.</p>
          <a class="button" href="{{couponPromotionViewAllURL}}">Get Started</a>
        </div>
        <div ng-show="showNoCouponMessageForMyExtras()" class="deals-section-error-action">
          <h2>{{couponPromotionMessageHeader}}</h2>
          <p class="-coupon-get-started">{{couponPromotionMessageText}}</p>
          <a class="button" href="{{couponPromotionButtonUrl}}" title="{{couponPromotionButtonAltId}}">{{couponPromotionButtonText}}</a>
        </div>
        <div ng-show="showNotLoggedInMessageForMyExtras()" class="deals-section-error-action">
          <h2>{{couponPromotionNotLoggedInMessageHeader}}</h2>
          <p class="-coupon-get-started">{{couponPromotionNotLoggedInMessageText}}</p>
          <a class="button" href="{{couponPromotionNotLoggedInButtonUrl}}" title="{{couponPromotionNotLoggedInButtonAltId}}">{{couponPromotionNotLoggedInButtonText}}</a>
        </div>
        <div ng-show="promotionsLoading" class="deals-section-error-loading">Loading</div>
      </div>
    </div>
  </div>
</section>

  <div id="noWeeklyAdsSection" class="deals-section deals-section-error-panel" ng-show="showWeeklyAdsError()" data-qa="no weekly ads error">
    <div class="deals-section-error-action">
      <p class="-error-weekly-ads">We're sorry, there was a problem while loading your weekly ad,
      and we're working to resolve the issue as soon as possible.
      Please try again later.</p>
    </div>
  </div>
  <div id="noCouponsSection" class="deals-section deals-section-error-panel" ng-show="showCouponsError()">
    <div class="deals-section-error-action" data-qa="no coupons error">
      <p>We're sorry, there was a problem loading your coupons,
      and we're working to resolve the issue as soon as possible.
      Please try again later.</p>
    </div>
  </div>
</div>





        </div>

        <section role="region" aria-label="Features" class="feature-section">
  <script>/*<![CDATA[*/
requireQ(["everything"], function() {
  common.register('melange.gadgets.feature', function (slot_content) {
    return function ($scope, $timeout, Content, Asset, Beacon, $window, windowSize) {
      if (slot_content.length == 0) return;
      $scope.features = [];
      $scope.isMultiFeatureContent = false;

      $scope.responsiveEnabled = windowSize.responsiveEnabled();
      var collection = slot_content[0];

      $scope.track = function (pos, link, headline) {
        Beacon.registerFeatureClick(link, pos, headline);
      };

      Content.query({id: _.map(collection.ids, function (item) { return item.identifier; })},
          function (data) {
            $scope.features = data;
            $scope.isMultiFeatureContent = $scope.features && $scope.features.length > 1;
            $.each($scope.features, function (index, feature) {
              if (feature && feature.image) {
                Asset.get({id: feature.image}, function (metadata) {
                  feature.imageMetadata = metadata;
                  feature.learnMoreLink = '/topic/' + feature.slug;
                });
              }
            });
            $('#featureCarousel').carousel({interval: false});
          });

      $scope.previous = function () {
        screenReaderMessage('You have scrolled to the previous feature.');
      }

      $scope.next = function () {
        screenReaderMessage('You have scrolled to the next feature.');
      }

      var screenReaderMessage = function (message) {
        $("#featureMessage").empty();
        $("#featureMessage").append('<div>'+message+'</div>');
        $timeout(function(){
          $("#featureMessage").empty();
        }, 500);
      }
    }
  });
});
/*]]>*/</script>
  <script>
    requireQ(["everything"], function() {
      melange.controller('feature_identifier', [
        '$scope', '$timeout', 'content.Service', 'asset.Service', 'beacon.Service', '$window', 'windowSize',
            melange.gadgets.feature([{'ids':[{'weight':2.503,'banners':{'BakersPlus':{'divisions':{'615':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'},'CityMarket':{'divisions':{'620':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'},'Dillons':{'divisions':{'615':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'},'Food4Less':{'divisions':{'704':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'708':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true},'FoodsCo':{'divisions':{'701':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'},'FrysFood':{'divisions':{'660':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'},'Gerbes':{'divisions':{'615':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'},'KingSoopers':{'divisions':{'620':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'},'Kroger':{'divisions':{'011':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'014':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'016':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'018':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'021':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'024':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'025':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'026':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'029':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'034':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true},'OwensMarket':{'divisions':{'021':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'},'PayLess':{'divisions':{'021':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'},'QFC':{'divisions':{'705':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'},'Ralphs':{'divisions':{'703':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'},'SmithsFoodAndDrug':{'divisions':{'706':{'weight':'0.06','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.06'}},'rules':{'and':[{'rule':'banners?.containsKey(bannerName)','weight':0.001},{'or':[{'and':[{'rule':'banners[bannerName]?.divisions?.containsKey(divisionNumber)','weight':'(banners[bannerName]?.divisions[divisionNumber]?.weight?:0.001).toDouble()'},{'rule':'((banners[bannerName]?.divisions[divisionNumber]?.startDate?:startDate)..(banners[bannerName]?.divisions[divisionNumber]?.endDate?:endDate)).containsWithinBounds(today)','weight':0.001}]},{'and':[{'rule':'banners[bannerName]?.allDivisionSelected','weight':'(banners[bannerName]?.weight?:0.001).toDouble()'},{'rule':'banners[bannerName].divisions.every{key,value-> ((value?.startDate?:startDate)..(value?.endDate?:endDate)).containsWithinBounds(today) }','weight':0.001}]}]},{'rule':'allowedLoginState == \'all\' || allowedLoginState == loggedIn.toString()','weight':0.5},{'rule':'allowedLoginStateShoppers == \'all\' || allowedLoginStateShoppers == hasLoyaltyCard.toString()','weight':0.5},{'rule':'userPreferredStore == \'all\' || userPreferredStore == hasPreferredStore.toString()','weight':0.5},{'rule':'registeredUser == \'all\' || registeredUser == isRegistered.toString()','weight':0.5},{'rule':'emailOptInUser == \'all\' || emailOptInUser == isEmailOptInUser.toString()','weight':0.5}]},'identifier':'572b4ea484ae1e7b757a789c','allowedLoginState':'all','allowedLoginStateShoppers':'all','userPreferredStore':'all','registeredUser':'all','emailOptInUser':'all'},{'weight':2.503,'banners':{'BakersPlus':{'divisions':{'615':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'},'CityMarket':{'divisions':{'620':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'},'Dillons':{'divisions':{'615':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'},'Food4Less':{'divisions':{'704':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'708':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true},'FoodsCo':{'divisions':{'701':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'},'FrysFood':{'divisions':{'660':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'},'Gerbes':{'divisions':{'615':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'},'KingSoopers':{'divisions':{'620':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'},'Kroger':{'divisions':{'011':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'014':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'016':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'018':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'021':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'024':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'025':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'026':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'029':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'},'034':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true},'OwensMarket':{'divisions':{'021':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'},'PayLess':{'divisions':{'021':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'},'QFC':{'divisions':{'705':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'},'Ralphs':{'divisions':{'703':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'},'SmithsFoodAndDrug':{'divisions':{'706':{'weight':'0.05','endDate':'2016-05-21T23:59:59.999-04:00','startDate':'2016-05-08T00:00:00.000-04:00'}},'allDivisionSelected':true,'weight':'0.05'}},'rules':{'and':[{'rule':'banners?.containsKey(bannerName)','weight':0.001},{'or':[{'and':[{'rule':'banners[bannerName]?.divisions?.containsKey(divisionNumber)','weight':'(banners[bannerName]?.divisions[divisionNumber]?.weight?:0.001).toDouble()'},{'rule':'((banners[bannerName]?.divisions[divisionNumber]?.startDate?:startDate)..(banners[bannerName]?.divisions[divisionNumber]?.endDate?:endDate)).containsWithinBounds(today)','weight':0.001}]},{'and':[{'rule':'banners[bannerName]?.allDivisionSelected','weight':'(banners[bannerName]?.weight?:0.001).toDouble()'},{'rule':'banners[bannerName].divisions.every{key,value-> ((value?.startDate?:startDate)..(value?.endDate?:endDate)).containsWithinBounds(today) }','weight':0.001}]}]},{'rule':'allowedLoginState == \'all\' || allowedLoginState == loggedIn.toString()','weight':0.5},{'rule':'allowedLoginStateShoppers == \'all\' || allowedLoginStateShoppers == hasLoyaltyCard.toString()','weight':0.5},{'rule':'userPreferredStore == \'all\' || userPreferredStore == hasPreferredStore.toString()','weight':0.5},{'rule':'registeredUser == \'all\' || registeredUser == isRegistered.toString()','weight':0.5},{'rule':'emailOptInUser == \'all\' || emailOptInUser == isEmailOptInUser.toString()','weight':0.5}]},'identifier':'572b48fc84ae1e7b757a7899','allowedLoginState':'all','allowedLoginStateShoppers':'all','userPreferredStore':'all','registeredUser':'all','emailOptInUser':'all'}]}] || [])
      ]);
    });
  </script>

    <div ng-controller="feature_identifier">
      <div id="featureCarousel" feature-carousel-swipe="" ng-swipe-left="swipeLeft()" ng-swipe-right="swipeRight()" next="next()" previous="previous()" class="carousel slide feature-carousel">
        <div id="featureMessage" class="offscreen" role="alert" aria-live="assertive" tabindex="-1"></div>
        <div ng-show="isMultiFeatureContent">
          <a class="left carousel-control" href="#featureCarousel" data-slide="prev" aria-label="Scroll Previous Feature" ng-click="previous()">&lsaquo;</a>
        </div>
        <div class="carousel-inner">
          <div ng-repeat="feature in features" ng-class="{item: true, active: $first}">
            <div class="feature" ng-show="feature" data-qa="feature carousel item">
              <span ng-if="!responsiveEnabled" ng-show="feature.imageMetadata.frames.feature" class="feature-image-container">
                <croppedimg src="{{ feature.image | assetSource }}" dimensions="feature.imageMetadata.frames.feature" viewport="274x274" imageMetaData="feature.imageMetadata"></croppedimg>
              </span>
              <span ng-if="responsiveEnabled" ng-show="feature.imageMetadata.frames.feature" class="feature-image-container">
                <span show-media-alt="" show-media-src="{{ feature.imageMetadata.frames.feature.channels.tablet.id | assetSource }}" show-media="(min-width: 321px) and (max-width: 610px)"></span>
                <span data-qa="feature carousel responsive default image" show-media-alt="" show-media-src="{{ feature.imageMetadata.frames.feature.channels.desktop.id | assetSource }}" show-media="(max-width: 320px), (min-width: 611px)" show-media-default="true"></span>
              </span>
              <div class="feature-text-container">
                <div id="featureDetails_{{ $index }}">
                  <h1 class="feature-text-header" data-qa="feature text header">{{ feature.heroPanelHeadline || feature.headline }}</h1>
                  <div class="feature-text-body" data-qa="feature text body" ng-bind-html=" (feature.heroPanelRotatorText || feature.body) | truncate: 350 | markdown | trusted"></div>
                </div>
                <a class="feature-text-link" data-qa="feature text link" ng-click="track($index, feature.learnMoreLink, feature.heroPanelHeadline ? feature.heroPanelHeadline : feature.headline)" href="" aria-describedby="featureDetails_{{ $index }}">{{(feature.callToActionText || "Learn More" )| truncate: 100 }}</a>
              </div>
            </div>
          </div>
        </div>
        <div ng-show="isMultiFeatureContent">
          <a class="right carousel-control" href="#featureCarousel" data-slide="next" aria-label="Scroll Next Feature" ng-click="next()">&rsaquo;</a>
        </div>
        <div class="carousel-indicators-wrapper" ng-show="features.length > 1">
          <ol class="carousel-indicators">
            <li keyboard-click="" data-target="#featureCarousel" data-slide-to="{{$index}}" ng-class="{active:$first}" ng-repeat="feature in features" tabindex="0" aria-label="blank"></li>
          </ol>
        </div>
      </div>
    </div>
</section>
      </div>
    </div>

    <div>
      <div>
  <div><!--
OnlineOpinion v5.6.5
Released: 12/17/2012. Compiled 01/02/2013 10:54:34 AM -0600
Branch: master 6f7c9076b20d959805996192556bbd12b2014c7d
Components: Full
The following code is Copyright 1998-2013 Opinionlab, Inc.  All rights reserved. Unauthorized use is prohibited. This product and other products of OpinionLab, Inc. are protected by U.S. Patent No. 6606581, 6421724, 6785717 B1 and other patents pending. http://www.opinionlab
--><!-- INVITATION PROMPT MARKUP --><noscript>This JavaScript enables OnlineOpinion, a method for collecting secure feedback data.</noscript>
<script>
  /*<![CDATA[*/
  requireQ(["everything"], function() {
    var invite_percentage = 5;
    var isOpinionLabAllowed = true;
    /*]]>*/

    // BST-3158 - Sadique and George - This is to take care of OpinionLab showing up on Android mobile devices.

    if (isOpinionLabAllowed) {
      var oo_invite = wireUpOpinionLabInvite();
    }

    function wireUpOpinionLabInvite() {
      return new OOo.Invitation({
        /* REQUIRED - Asset identification */
        pathToAssets: '/fragment/',
        /* OPTIONAL - Configuration */
        promptMarkup: 'opinionlabInvitationPrompt',
        monitorWindow: 'opinionlabInvitationMonitor',
        responseRate: invite_percentage,
        repromptTime: 2592000,
        promptDelay: 4,
        popupType: 'popunder',
//	, companyLogo: '/onlineopinionV5/logo.gif'  // 355px by 55px
        referrerRewrite: {
          searchPattern: /:\/\//g,
          replacePattern: '://invite.'
        }
      });
    };
  });
</script>
<!-- END: OnlineOpinion v5.6.5 --></div>
</div>
    </div>
  </div>
<div><script>/*<![CDATA[*/
requireQ(["everything"], function () {
   common.register('melange.gadgets.promoRightPanel',
         melange.gadgets.promoRightPanel = function ($scope, $window, Beacon, EnvLookup) {
            $scope.shouldShowRightPanel = function () {
               if ($scope.bannerName === 'KingSoopers') {
                  return EnvLookup.promoSidePanelEnabled != undefined && EnvLookup.promoSidePanelEnabled;
               }
               return false
            };
            $scope.navigateToLiveNaturally = function () {
               Beacon.registerPromoLinkClick("rightpanel_livenaturallypromo2015");
               $window.open($scope.targetPromoUrl, '_blank');
            };

            $scope.bannerName = EnvLookup.bannerName;
            $scope.imgUrl = EnvLookup.promotionRightPanelAsset;
            $scope.targetPromoUrl = EnvLookup.liveNaturallyRightPanelLink;
            $scope.promotionRightPanelAltText = EnvLookup.promotionRightPanelAltText;
         });
   melange.controller('promoRightPanelController',
         ['$scope', '$window', 'beacon.Service', 'EnvLookup', melange.gadgets.promoRightPanel]);
});
/*]]>*/
</script>
<div ng-controller="promoRightPanelController">
    <div ng-if="shouldShowRightPanel()" class="promoPanels">
        <a href="" aria-label="{{ promotionRightPanelAltText }}" tabindex="0" ng-click="navigateToLiveNaturally()">
            <span show-media-src="{{ imgUrl }}" show-media="(min-width: 1280px)" show-media-default="false" id="promoRightPanelAsset"></span>
        </a>
    </div>
</div></div>
</div>

<div><footer role="contentinfo">
    <div>
  <div class="scoped-to-banner footer-background">
    <script>
      requireQ(["everything"], function() {
        melange.controller('footer_identifier', [
          '$scope', 'content.Service', '$window', 'trackable.Service',
          function ($scope, Content, $window, Trackable) {
            var slot_content =
            ['5245e9743283475a6784e586']
            ||
            [];
            Content.queryBySlotContent(slot_content, function (data) {
              var html = $(data[0].body);
              var trackableHTML = $(Trackable.trackAnchors(html, "footer"));
              trackableHTML.find('#responsive-footer-feedback')
                  .attr('onclick', 'return openOpinionLabPopup()');

              $window.openOpinionLabPopup = function () {
                $scope.$emit('showOpinionLabPopup');
                $scope.$apply();
                return false;
              };

              if (trackableHTML.size() > 0) {
                $scope.messages = trackableHTML[0].outerHTML;
              }
            });
          }
        ]);
      });
    </script>
    <div class="banner-footer" ng-bind-html="messages | trusted" ng-controller="footer_identifier"></div>
    <div class="version">
      <div style="display:none;">site</div>
      <div style="display:none;">5.52.4-14_g17d429e/18</div>
    </div>
    <span seo-crawlable-indicator="true"></span>
  </div>
</div>
    <div>
  <div class="scoped-to-banner">
    <div class="footerCopyRights">
      <p>All Contents &copy; Copyright <span>2016</span> The Kroger Co. All Rights Reserved </p>
      <p class="policyLinks"><a href="/pharmacyprivacy">Pharmacy Privacy Notice</a> <span class="footer-copyright-pipe">|</span>
        <a data-qa="terms_and_conditions" href="/termsandconditions">Terms and Conditions</a> <span class="footer-copyright-pipe">|</span>
        <a data-qa="privacy_policy" href="/privacypolicy">Privacy Policy</a></p>
    </div>
  </div>
</div>
    <div>

<script type="text/javascript">
window.localEnvironment.socialRibbon = {
  facebook:'https://www.facebook.com/Kroger/app_190322544333196',
  twitter:'https://twitter.com/Kroger',
  youtube:'https://www.youtube.com/kroger',
  pinterest:'https://pinterest.com/krogerco/',
  mobilegoogleplay:'https://play.google.com/store/apps/details?id=com.kroger.mobile',
  mobileappstore:'https://itunes.apple.com/us/app/kroger-co./id403901186?ls=1%26mt=8'
};


</script>
<script>/*<![CDATA[*/
requireQ(["everything"], function() {
  common.register('melange.gadgets.socialRibbon',
      melange.gadgets.socialRibbon = function ($scope, $window) {
        $scope.twitter = $window.localEnvironment.socialRibbon.twitter;
        $scope.facebook = $window.localEnvironment.socialRibbon.facebook;
        $scope.youtube = $window.localEnvironment.socialRibbon.youtube;
        $scope.pinterest = $window.localEnvironment.socialRibbon.pinterest;
        $scope.android = $window.localEnvironment.socialRibbon.mobilegoogleplay;
        $scope.apple = $window.localEnvironment.socialRibbon.mobileappstore;

        $scope.showTwitter = !_.isEmpty($scope.twitter);
        $scope.showFacebook = !_.isEmpty($scope.facebook);
        $scope.showPinterest = !_.isEmpty($scope.pinterest);
        $scope.showYoutube = !_.isEmpty($scope.youtube);
        $scope.showAndroid = !_.isEmpty($scope.android);
        $scope.showApple = !_.isEmpty($scope.apple);
        $scope.isSocialIconsEmpty =
        (_.isEmpty($scope.twitter) && _.isEmpty($scope.facebook) && _.isEmpty($scope.youtube) &&
         _.isEmpty($scope.pinterest));
        $scope.isMobileIconsEmpty = (_.isEmpty($scope.android) && _.isEmpty($scope.apple));
        $scope.ribbonVisible = !($scope.isSocialIconsEmpty && $scope.isMobileIconsEmpty);
      });

  melange.controller('socialRibbonController', ['$scope', '$window', melange.gadgets.socialRibbon]);
});
/*]]>*/
</script>
<div ng-controller="socialRibbonController" ng-show="ribbonVisible" class="scoped-to-banner footer-background">
  <div class="socialIconRibbon">
    <ul id="socialRibbon">
      <li class="twitter" data-qa="socialRibbon.twitter" ng-show="showTwitter"><a ng-href="{{twitter}}"></a></li>
      <li class="facebook" data-qa="socialRibbon.facebook" ng-show="showFacebook"><a ng-href="{{facebook}}"></a></li>
      <li class="youtube" data-qa="socialRibbon.youtube" ng-show="showYoutube"><a ng-href="{{youtube}}"></a></li>
      <li class="pininterest" data-qa="socialRibbon.pininterest" ng-show="showPinterest"><a ng-href="{{pinterest}}"></a></li>
      <li class="separator" data-qa="socialRibbon.separator" ng-hide="isSocialIconsEmpty || isMobileIconsEmpty"></li>
      <ul class="mobile-app-icons">
        <li class="android" data-qa="socialRibbon.android" ng-show="showAndroid"><a ng-href="{{android}}"></a></li>
        <li class="apple" data-qa="socialRibbon.apple" ng-show="showApple"><a ng-href="{{apple}}"></a></li>
      </ul>
    </ul>
  </div>
</div>
</div>
</footer></div>
<div><script language="JavaScript">
  requireQ(["everything"], function() {
    var omnitureEnabled = 'true';
    melange.app.beacon.omnitureAccount = 'krgrkrogerprod,krgrglobalprod';
    melange.app.beacon.globals =
    {
      loggedIn: false,
      bannerName: 'Kroger',
      pid: '',
      channel: 'web',
      loyalMember: null
    };

    var track = function() {};

    melange.controller('TrackingController', [
      '$rootScope', 'beacon.Service', function ($rootScope, Beacon) {
        var topNavLoaded, topicLoaded, pageLoadSent = false;
        var waitForTopic = location.pathname.indexOf("/topic/") == 0;

        $rootScope.$on('topNavigationLoaded', function () {
          topNavLoaded = true;
          if (!waitForTopic || topicLoaded) {
            pageLoad();
          }
        });

        $rootScope.$on('topicLoaded', function () {
          topicLoaded = true;
          if (topNavLoaded) {
            pageLoad();
          }
        });

        function pageLoad() {
          if (!pageLoadSent) {
            pageLoadSent = true;
            Beacon.registerPageLoad();
          }
        };

        window.track = function (elementName, pageName, href, navType) {
          if (omnitureEnabled === 'true') {
            if (navType == 'topnav') {
              return Beacon.registerNavClick('topnav_' + elementName, href);
            }
            else if(navType == 'topic') {
              return Beacon.registerTopicHrefClick('topic_' + pageName + '_' + elementName, href);
            }
            else {
              return Beacon.registerFooterLinkClick('footer_' + elementName, href);
            }
          }
        };
      }
    ]);
  });
</script>
<noscript>
  <a href="http://www.omniture.com" title="Web Analytics">
    <img height="1" width="1" border="0" alt="" src="http://krgrkrogerprod,krgrglobalprod.112.2O7.net/b/ss/krgrkrogerprod,krgrglobalprod/1/H.14--NS/0" />
  </a>
</noscript>

<div ng-controller="TrackingController" style="display:none;">
</div></div>
</div>

<div><script>
  Q.all(allAppPromises).then(function() {
    appReadyDeferred.resolve();
  });
  var addViewportMetaTagForResponsive = function() {
    if(document.getElementById("grid-wrap").className.indexOf('row-fluid') > -1){
      var viewPortTag = document.createElement('meta');
      viewPortTag.id = "viewport";
      viewPortTag.name = "viewport";
      viewPortTag.content = "user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1";
      window.parent.document.getElementsByTagName('head')[0].appendChild(viewPortTag);
    }
  }
  addViewportMetaTagForResponsive();

</script>

</div>
</body>
</html>